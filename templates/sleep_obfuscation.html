{% extends "base.html" %}
{% block body %}
<div class="main-container">
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                    <path d="M2 17l10 5 10-5"/>
                    <path d="M2 12l10 5 10-5"/>
                </svg>
                <span class="logo-text">SHADOW<span class="accent">ARSENAL</span></span>
            </div>
        </div>
        <ul class="nav-menu">
            <li class="nav-item"><a href="/" class="nav-link"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg><span>DASHBOARD</span></a></li>
            <li class="nav-item"><a href="/evasion/" class="nav-link"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>EVASION TEST</span></a></li>
            <li class="nav-item"><a href="/evasion/sleep/" class="nav-link active"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg><span>SLEEP EVASION</span></a></li>
            <li class="nav-item"><a href="/kerberos" class="nav-link"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg><span>KERBEROS</span></a></li>
            <li class="nav-item"><a href="/lateral/" class="nav-link"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 3h5v5"/><path d="M21 3l-7 7"/></svg><span>LATERAL MOVE</span></a></li>
            <li class="nav-item"><a href="/c2" class="nav-link"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 3a3 3 0 00-3 3v12a3 3 0 003 3"/></svg><span>C2 IMPLANT</span></a></li>
        </ul>
        <div class="sidebar-footer">
            <div class="status-indicator online"><span class="status-dot"></span><span>AI ENGINE READY</span></div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="content-area">
        <!-- Header -->
        <header class="page-header">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="page-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 6v6l4 2"/>
                        </svg>
                        <span>AI SLEEP OBFUSCATION</span>
                    </h1>
                    <p class="page-subtitle">Adaptive jitter patterns with EDR evasion - Ghost Mode for hours/days undetected</p>
                </div>
                <div class="header-right">
                    <div class="quick-stats">
                        <div class="quick-stat cyan">
                            <span class="stat-value" id="activeSessionsCount">0</span>
                            <span class="stat-label">Active Sessions</span>
                        </div>
                        <div class="quick-stat purple">
                            <span class="stat-value" id="detectedEDR">--</span>
                            <span class="stat-label">Detected EDR</span>
                        </div>
                        <div class="quick-stat green">
                            <span class="stat-value" id="ghostScore">0%</span>
                            <span class="stat-label">Ghost Score</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Info Banner -->
        <section class="info-banner cyan">
            <div class="info-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="16" x2="12" y2="12"/>
                    <line x1="12" y1="8" x2="12.01" y2="8"/>
                </svg>
            </div>
            <div class="info-content">
                <h3>AI-Dynamic Sleep Evasion Features</h3>
                <div class="info-items">
                    <div class="info-item"><span class="badge cyan">AI-ADAPT</span><span>Auto-adjusts jitter based on detected EDR products</span></div>
                    <div class="info-item"><span class="badge purple">MULTI-PATTERN</span><span>Gaussian, Fibonacci, Poisson, ML-Entropy patterns</span></div>
                    <div class="info-item"><span class="badge green">RUNTIME MUTATE</span><span>Memory obfuscation + syscall jitter during sleep</span></div>
                    <div class="info-item"><span class="badge orange">OPSEC</span><span>Telemetry spoof + log wipe for maximum stealth</span></div>
                </div>
            </div>
        </section>

        <!-- Tab Navigation -->
        <section class="tabs-section">
            <div class="tabs-nav">
                <button class="tab-btn active cyan" data-tab="config">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
                    <span>Configuration</span>
                </button>
                <button class="tab-btn purple" data-tab="patterns">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                    <span>Jitter Patterns</span>
                </button>
                <button class="tab-btn green" data-tab="edr">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                    <span>EDR Profiles</span>
                </button>
                <button class="tab-btn orange" data-tab="sessions">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                    <span>Sessions</span>
                </button>
            </div>
        </section>

        <!-- Main Content Grid -->
        <div class="content-grid">
            <!-- Forms Column -->
            <div class="forms-column">
                <!-- Configuration Panel -->
                <div class="form-panel" id="config-panel">
                    <div class="panel-header cyan">
                        <div class="panel-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83"/></svg></div>
                        <div class="panel-title">
                            <h2>Sleep Obfuscation Config</h2>
                            <p>Configure AI-adaptive jitter for beacon sleep</p>
                        </div>
                    </div>
                    <div class="panel-body">
                        <!-- Profile Presets -->
                        <div class="profile-presets">
                            <h4>Quick Profiles</h4>
                            <div class="preset-cards">
                                <div class="preset-card" data-profile="ghost" onclick="loadProfile('ghost')">
                                    <div class="preset-icon">üëª</div>
                                    <h5>Ghost Mode</h5>
                                    <p>Max stealth, 60s+ intervals</p>
                                </div>
                                <div class="preset-card" data-profile="interactive" onclick="loadProfile('interactive')">
                                    <div class="preset-icon">‚ö°</div>
                                    <h5>Interactive</h5>
                                    <p>5s intervals, balanced</p>
                                </div>
                                <div class="preset-card" data-profile="aggressive" onclick="loadProfile('aggressive')">
                                    <div class="preset-icon">üöÄ</div>
                                    <h5>Aggressive</h5>
                                    <p>1s intervals, fast ops</p>
                                </div>
                            </div>
                        </div>

                        <div class="form-divider"></div>

                        <div class="form-group">
                            <label class="form-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>Base Sleep (ms)</label>
                            <input type="number" id="baseSleepMs" class="form-input cyan" value="30000" min="1000" max="300000">
                            <div class="input-hint">Minimum: 1000ms (1s), Maximum: 300000ms (5min)</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>Jitter Percent</label>
                            <input type="range" id="jitterPercent" class="form-range cyan" value="50" min="10" max="100">
                            <div class="range-value"><span id="jitterValue">50</span>%</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>Jitter Pattern</label>
                            <select id="jitterPattern" class="form-input cyan">
                                <option value="adaptive">ü§ñ Adaptive (AI-Selected)</option>
                                <option value="hybrid">üîÄ Hybrid (Multi-Pattern)</option>
                                <option value="gaussian">üìä Gaussian (Natural)</option>
                                <option value="fibonacci">üî¢ Fibonacci (Mathematical)</option>
                                <option value="poisson">üìà Poisson (Event-Based)</option>
                                <option value="ml_entropy">üß† ML-Entropy (GAN-Like)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>OPSEC Level</label>
                            <div class="opsec-selector">
                                <button class="opsec-btn" data-level="1" onclick="setOpsecLevel(1)">1<span>Basic</span></button>
                                <button class="opsec-btn" data-level="2" onclick="setOpsecLevel(2)">2<span>Medium</span></button>
                                <button class="opsec-btn active" data-level="3" onclick="setOpsecLevel(3)">3<span>High</span></button>
                                <button class="opsec-btn" data-level="4" onclick="setOpsecLevel(4)">4<span>Paranoid</span></button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>EDR Override</label>
                            <select id="edrOverride" class="form-input cyan">
                                <option value="">Auto-Detect</option>
                                <option value="falcon">CrowdStrike Falcon</option>
                                <option value="defender">MS Defender ATP</option>
                                <option value="carbonblack">Carbon Black</option>
                                <option value="sentinelone">SentinelOne</option>
                                <option value="elastic">Elastic EDR</option>
                                <option value="none">No EDR</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/></svg>Session ID</label>
                            <input type="text" id="sessionId" class="form-input cyan" placeholder="beacon_001">
                        </div>

                        <button class="btn-submit cyan" onclick="configureSession()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                            Create Session
                        </button>
                    </div>
                </div>

                <!-- Jitter Patterns Panel -->
                <div class="form-panel hidden" id="patterns-panel">
                    <div class="panel-header purple">
                        <div class="panel-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg></div>
                        <div class="panel-title">
                            <h2>Jitter Pattern Visualization</h2>
                            <p>Generate and analyze jitter distributions</p>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="pattern-info-cards">
                            <div class="pattern-card" data-pattern="gaussian">
                                <div class="pattern-icon">üìä</div>
                                <h4>Gaussian</h4>
                                <p>Normal distribution - mimics natural network variance</p>
                                <span class="pattern-best">Best vs: Basic detection</span>
                            </div>
                            <div class="pattern-card" data-pattern="fibonacci">
                                <div class="pattern-icon">üî¢</div>
                                <h4>Fibonacci</h4>
                                <p>Mathematical sequence - hard to fingerprint</p>
                                <span class="pattern-best">Best vs: CrowdStrike</span>
                            </div>
                            <div class="pattern-card" data-pattern="poisson">
                                <div class="pattern-icon">üìà</div>
                                <h4>Poisson</h4>
                                <p>Event-based timing - realistic network behavior</p>
                                <span class="pattern-best">Best vs: Defender ATP</span>
                            </div>
                            <div class="pattern-card" data-pattern="ml_entropy">
                                <div class="pattern-icon">üß†</div>
                                <h4>ML-Entropy</h4>
                                <p>GAN-like generation - defeats ML detection</p>
                                <span class="pattern-best">Best vs: SentinelOne</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Sample Count</label>
                            <input type="number" id="sampleCount" class="form-input purple" value="50" min="10" max="500">
                        </div>

                        <button class="btn-submit purple" onclick="generateJitterSamples()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                            Generate Samples
                        </button>

                        <div class="jitter-chart" id="jitterChart">
                            <div class="chart-placeholder">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                                <p>Generate samples to visualize jitter distribution</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- EDR Profiles Panel -->
                <div class="form-panel hidden" id="edr-panel">
                    <div class="panel-header green">
                        <div class="panel-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div>
                        <div class="panel-title">
                            <h2>EDR Detection Profiles</h2>
                            <p>AI-recommended configurations per EDR product</p>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="edr-profiles" id="edrProfiles">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Sessions Panel -->
                <div class="form-panel hidden" id="sessions-panel">
                    <div class="panel-header orange">
                        <div class="panel-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/></svg></div>
                        <div class="panel-title">
                            <h2>Active Sessions</h2>
                            <p>Manage beacon sleep configurations</p>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="sessions-list" id="sessionsList">
                            <div class="empty-state">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/></svg>
                                <p>No active sessions</p>
                                <span>Create a configuration to start</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Terminal & Stats Column -->
            <div class="terminal-column">
                <!-- Statistics Panel -->
                <div class="stats-panel">
                    <div class="stats-header">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                        <span>Jitter Statistics</span>
                    </div>
                    <div class="stats-body" id="statsBody">
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-label">Average</span>
                                <span class="stat-value" id="statAvg">--</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Min</span>
                                <span class="stat-value" id="statMin">--</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Max</span>
                                <span class="stat-value" id="statMax">--</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Std Dev</span>
                                <span class="stat-value" id="statStdDev">--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- OPSEC Features Panel -->
                <div class="opsec-panel">
                    <div class="opsec-header">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                        <span>OPSEC Features (Level <span id="currentOpsecLevel">3</span>)</span>
                    </div>
                    <div class="opsec-body">
                        <div class="opsec-feature" id="feat-syscall">
                            <span class="feature-icon">‚öôÔ∏è</span>
                            <span class="feature-name">Indirect Syscalls</span>
                            <span class="feature-status enabled">ENABLED</span>
                        </div>
                        <div class="opsec-feature" id="feat-memory">
                            <span class="feature-icon">üîê</span>
                            <span class="feature-name">Memory Encryption</span>
                            <span class="feature-status enabled">ENABLED</span>
                        </div>
                        <div class="opsec-feature" id="feat-activity">
                            <span class="feature-icon">üëª</span>
                            <span class="feature-name">Fake Process Activity</span>
                            <span class="feature-status enabled">ENABLED</span>
                        </div>
                        <div class="opsec-feature" id="feat-logs">
                            <span class="feature-icon">üßπ</span>
                            <span class="feature-name">Log Cleanup</span>
                            <span class="feature-status disabled">LEVEL 4+</span>
                        </div>
                    </div>
                </div>

                <!-- Terminal Output -->
                <div class="terminal-panel">
                    <div class="terminal-header">
                        <div class="terminal-dots"><span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span></div>
                        <div class="terminal-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"/></svg><span>Sleep Engine Output</span></div>
                        <button class="btn-clear" onclick="clearTerminal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"/></svg></button>
                    </div>
                    <div class="terminal-body" id="terminal">
                        <div class="terminal-content" id="terminal-content">
                            <div class="terminal-line info"><span class="prompt">[*]</span><span>AI-Adaptive Sleep Obfuscation Engine v2.0</span></div>
                            <div class="terminal-line info"><span class="prompt">[*]</span><span>Multi-pattern jitter: Gaussian, Fibonacci, Poisson, ML-Entropy</span></div>
                            <div class="terminal-line info"><span class="prompt">[*]</span><span>EDR auto-detection enabled</span></div>
                            <div class="terminal-divider"></div>
                        </div>
                    </div>
                </div>

                <!-- Export Panel -->
                <div class="export-panel">
                    <div class="export-header">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                        <span>Export Configuration</span>
                    </div>
                    <div class="export-body">
                        <select id="exportSession" class="form-input">
                            <option value="">Select session...</option>
                        </select>
                        <button class="btn-export" onclick="exportConfig()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="7 10 12 15 17 10"/></svg>
                            Export Python Code
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<script>
let currentTab = 'config';
let opsecLevel = 3;
let profiles = {};
let edrConfigs = {};

document.addEventListener('DOMContentLoaded', function() {
    initTabs();
    loadProfiles();
    loadSessions();
    updateOpsecFeatures();
    
    // Jitter slider
    document.getElementById('jitterPercent').addEventListener('input', function() {
        document.getElementById('jitterValue').textContent = this.value;
    });
});

function initTabs() {
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const tab = this.dataset.tab;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            document.querySelectorAll('.form-panel').forEach(p => p.classList.add('hidden'));
            document.getElementById(tab + '-panel').classList.remove('hidden');
            currentTab = tab;
            log('‚îÄ'.repeat(40), 'dim');
            log(`Switched to ${tab.toUpperCase()} mode`, 'info');
        });
    });
}

function log(message, type = 'info') {
    const terminal = document.getElementById('terminal-content');
    const div = document.createElement('div');
    div.className = `terminal-line ${type}`;
    if (type === 'dim') {
        div.innerHTML = `<span class="divider">${message}</span>`;
    } else {
        const prefixes = { success: '[+]', error: '[!]', warning: '[*]', info: '[*]' };
        div.innerHTML = `<span class="prompt">${prefixes[type] || '[*]'}</span><span>${message}</span>`;
    }
    terminal.appendChild(div);
    document.getElementById('terminal').scrollTop = document.getElementById('terminal').scrollHeight;
}

function clearTerminal() {
    document.getElementById('terminal-content').innerHTML = `
        <div class="terminal-line info"><span class="prompt">[*]</span><span>Terminal cleared</span></div>
        <div class="terminal-divider"></div>
    `;
}

async function loadProfiles() {
    try {
        const response = await fetch('/evasion/sleep/profiles');
        const data = await response.json();
        if (data.success) {
            profiles = data.profiles;
            edrConfigs = data.edr_configs;
            renderEDRProfiles();
            log('Loaded sleep profiles and EDR configurations', 'success');
        }
    } catch (e) {
        log(`Failed to load profiles: ${e.message}`, 'error');
    }
}

function renderEDRProfiles() {
    const container = document.getElementById('edrProfiles');
    container.innerHTML = Object.entries(edrConfigs).map(([key, cfg]) => `
        <div class="edr-card" data-edr="${key}">
            <div class="edr-header">
                <span class="edr-name">${cfg.name}</span>
                <span class="edr-pattern badge ${cfg.recommended_pattern === 'fibonacci' ? 'purple' : cfg.recommended_pattern === 'poisson' ? 'green' : 'cyan'}">${cfg.recommended_pattern}</span>
            </div>
            <div class="edr-capabilities">
                <div class="capability ${cfg.behavioral_ml ? 'active' : ''}">
                    <span class="cap-icon">${cfg.behavioral_ml ? '‚úì' : '‚úó'}</span>
                    <span>Behavioral ML</span>
                </div>
                <div class="capability ${cfg.memory_scanning ? 'active' : ''}">
                    <span class="cap-icon">${cfg.memory_scanning ? '‚úì' : '‚úó'}</span>
                    <span>Memory Scan</span>
                </div>
                <div class="capability ${cfg.sleep_pattern_detection ? 'active' : ''}">
                    <span class="cap-icon">${cfg.sleep_pattern_detection ? '‚úì' : '‚úó'}</span>
                    <span>Sleep Detection</span>
                </div>
                <div class="capability ${cfg.syscall_hooking ? 'active' : ''}">
                    <span class="cap-icon">${cfg.syscall_hooking ? '‚úì' : '‚úó'}</span>
                    <span>Syscall Hook</span>
                </div>
            </div>
            <div class="edr-settings">
                <span>Min Sleep: ${cfg.min_sleep_ms}ms</span>
                <span>Max Jitter: ${cfg.max_jitter_percent}%</span>
            </div>
        </div>
    `).join('');
}

function loadProfile(profileName) {
    if (!profiles[profileName]) return;
    const p = profiles[profileName];
    document.getElementById('baseSleepMs').value = p.base_sleep_ms;
    document.getElementById('jitterPercent').value = p.jitter_percent;
    document.getElementById('jitterValue').textContent = p.jitter_percent;
    document.getElementById('jitterPattern').value = p.pattern;
    setOpsecLevel(p.opsec_level);
    
    // Highlight selected preset
    document.querySelectorAll('.preset-card').forEach(c => c.classList.remove('selected'));
    document.querySelector(`.preset-card[data-profile="${profileName}"]`)?.classList.add('selected');
    
    log(`Loaded profile: ${profileName}`, 'success');
}

function setOpsecLevel(level) {
    opsecLevel = level;
    document.querySelectorAll('.opsec-btn').forEach(btn => {
        btn.classList.toggle('active', parseInt(btn.dataset.level) === level);
    });
    document.getElementById('currentOpsecLevel').textContent = level;
    updateOpsecFeatures();
    
    // Update ghost score
    const ghostScore = Math.min(100, level * 25);
    document.getElementById('ghostScore').textContent = ghostScore + '%';
}

function updateOpsecFeatures() {
    const features = {
        'feat-syscall': opsecLevel >= 4,
        'feat-memory': opsecLevel >= 2,
        'feat-activity': opsecLevel >= 2,
        'feat-logs': opsecLevel >= 4
    };
    
    Object.entries(features).forEach(([id, enabled]) => {
        const el = document.getElementById(id);
        const status = el.querySelector('.feature-status');
        if (enabled) {
            status.textContent = 'ENABLED';
            status.className = 'feature-status enabled';
        } else {
            status.textContent = `LEVEL ${id === 'feat-syscall' || id === 'feat-logs' ? '4' : '2'}+`;
            status.className = 'feature-status disabled';
        }
    });
}

async function configureSession() {
    const sessionId = document.getElementById('sessionId').value || `beacon_${Date.now()}`;
    
    log('‚îÄ'.repeat(40), 'dim');
    log(`Configuring session: ${sessionId}`, 'info');
    
    try {
        const response = await fetch('/evasion/sleep/configure', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                session_id: sessionId,
                base_sleep_ms: parseInt(document.getElementById('baseSleepMs').value),
                jitter_percent: parseInt(document.getElementById('jitterPercent').value),
                pattern: document.getElementById('jitterPattern').value,
                opsec_level: opsecLevel,
                edr_override: document.getElementById('edrOverride').value || null,
                auto_detect_edr: !document.getElementById('edrOverride').value
            })
        });
        
        const data = await response.json();
        if (data.success) {
            log(`Session created: ${data.session_id}`, 'success');
            log(`  Pattern: ${data.config.pattern}`, 'info');
            log(`  Base Sleep: ${data.config.base_sleep_ms}ms`, 'info');
            log(`  Detected EDR: ${data.config.detected_edr}`, 'info');
            
            document.getElementById('detectedEDR').textContent = data.config.detected_edr.toUpperCase();
            loadSessions();
        } else {
            log(`Failed: ${data.error}`, 'error');
        }
    } catch (e) {
        log(`Error: ${e.message}`, 'error');
    }
}

async function loadSessions() {
    try {
        const response = await fetch('/evasion/sleep/sessions');
        const data = await response.json();
        
        document.getElementById('activeSessionsCount').textContent = data.count;
        
        const container = document.getElementById('sessionsList');
        const exportSelect = document.getElementById('exportSession');
        
        if (data.sessions.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/></svg>
                    <p>No active sessions</p>
                </div>
            `;
            exportSelect.innerHTML = '<option value="">No sessions</option>';
            return;
        }
        
        container.innerHTML = data.sessions.map(s => `
            <div class="session-card">
                <div class="session-header">
                    <span class="session-id">${s.session_id}</span>
                    <span class="session-pattern badge cyan">${s.pattern}</span>
                </div>
                <div class="session-details">
                    <span>Sleep: ${s.base_sleep_ms}ms</span>
                    <span>OPSEC: ${s.opsec_level}</span>
                    <span>EDR: ${s.detected_edr}</span>
                </div>
                <div class="session-actions">
                    <button class="btn-mini" onclick="simulateSleep('${s.session_id}')">Test</button>
                    <button class="btn-mini danger" onclick="deleteSession('${s.session_id}')">Delete</button>
                </div>
            </div>
        `).join('');
        
        exportSelect.innerHTML = '<option value="">Select session...</option>' +
            data.sessions.map(s => `<option value="${s.session_id}">${s.session_id}</option>`).join('');
    } catch (e) {
        log(`Failed to load sessions: ${e.message}`, 'error');
    }
}

async function simulateSleep(sessionId) {
    log('‚îÄ'.repeat(40), 'dim');
    log(`Simulating sleep for: ${sessionId}`, 'info');
    
    try {
        const response = await fetch('/evasion/sleep/simulate', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ session_id: sessionId })
        });
        
        const data = await response.json();
        if (data.success) {
            const sim = data.simulation;
            log(`Calculated duration: ${sim.calculated_duration_ms}ms`, 'success');
            log(`  Chunk count: ${sim.chunk_count}`, 'info');
            log(`  Syscall: ${sim.syscall_method}`, 'info');
            log(`  Memory encryption: ${sim.memory_encryption}`, 'info');
            log(`  Fake activity: ${sim.fake_activity}`, 'info');
            log(`  Log cleanup: ${sim.log_cleanup}`, 'info');
        }
    } catch (e) {
        log(`Error: ${e.message}`, 'error');
    }
}

async function deleteSession(sessionId) {
    try {
        const response = await fetch(`/evasion/sleep/delete/${sessionId}`, { method: 'DELETE' });
        const data = await response.json();
        if (data.success) {
            log(`Deleted session: ${sessionId}`, 'warning');
            loadSessions();
        }
    } catch (e) {
        log(`Error: ${e.message}`, 'error');
    }
}

async function generateJitterSamples() {
    const count = parseInt(document.getElementById('sampleCount').value);
    const pattern = document.getElementById('jitterPattern').value;
    
    log('‚îÄ'.repeat(40), 'dim');
    log(`Generating ${count} jitter samples (${pattern})...`, 'info');
    
    try {
        const response = await fetch('/evasion/sleep/generate-jitter', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                count,
                pattern,
                base_sleep_ms: parseInt(document.getElementById('baseSleepMs').value),
                jitter_percent: parseInt(document.getElementById('jitterPercent').value)
            })
        });
        
        const data = await response.json();
        if (data.success) {
            renderJitterChart(data.samples);
            updateStats(data.statistics);
            log(`Generated ${count} samples`, 'success');
        }
    } catch (e) {
        log(`Error: ${e.message}`, 'error');
    }
}

function renderJitterChart(samples) {
    const chart = document.getElementById('jitterChart');
    const maxDuration = Math.max(...samples.map(s => s.duration_ms));
    
    chart.innerHTML = `
        <div class="chart-container">
            <div class="chart-bars">
                ${samples.map((s, i) => `
                    <div class="chart-bar" style="height: ${(s.duration_ms / maxDuration) * 100}%" title="${s.duration_ms.toFixed(0)}ms"></div>
                `).join('')}
            </div>
            <div class="chart-labels">
                <span>0</span>
                <span>${samples.length}</span>
            </div>
        </div>
    `;
}

function updateStats(stats) {
    document.getElementById('statAvg').textContent = (stats.average_ms / 1000).toFixed(2) + 's';
    document.getElementById('statMin').textContent = (stats.min_ms / 1000).toFixed(2) + 's';
    document.getElementById('statMax').textContent = (stats.max_ms / 1000).toFixed(2) + 's';
    document.getElementById('statStdDev').textContent = (stats.std_deviation / 1000).toFixed(2) + 's';
}

async function exportConfig() {
    const sessionId = document.getElementById('exportSession').value;
    if (!sessionId) {
        log('Select a session to export', 'error');
        return;
    }
    
    try {
        const response = await fetch(`/evasion/sleep/export-config/${sessionId}`);
        const data = await response.json();
        
        if (data.success) {
            log('‚îÄ'.repeat(40), 'dim');
            log('Export configuration:', 'success');
            log(data.config_code, 'info');
            
            // Copy to clipboard
            navigator.clipboard.writeText(data.config_code);
            log('Copied to clipboard!', 'success');
        }
    } catch (e) {
        log(`Error: ${e.message}`, 'error');
    }
}
</script>

<style>
.main-container { display: flex; min-height: 100vh; }
.sidebar { width: 260px; background: rgba(15, 15, 25, 0.95); border-right: 1px solid rgba(255, 255, 255, 0.05); display: flex; flex-direction: column; position: fixed; height: 100vh; z-index: 100; }
.sidebar-header { padding: 20px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
.logo { display: flex; align-items: center; gap: 12px; color: #fff; }
.logo svg { width: 32px; height: 32px; color: #00d4ff; }
.logo-text { font-size: 14px; font-weight: 700; letter-spacing: 2px; }
.logo-text .accent { color: #00d4ff; }
.nav-menu { list-style: none; padding: 15px 10px; margin: 0; flex: 1; }
.nav-item { margin-bottom: 5px; }
.nav-link { display: flex; align-items: center; gap: 12px; padding: 12px 15px; color: rgba(255, 255, 255, 0.6); text-decoration: none; font-size: 12px; font-weight: 600; letter-spacing: 1px; border-radius: 8px; transition: all 0.3s ease; }
.nav-link svg { width: 20px; height: 20px; }
.nav-link:hover { background: rgba(255, 255, 255, 0.05); color: #fff; }
.nav-link.active { background: rgba(0, 212, 255, 0.1); color: #00d4ff; }
.sidebar-footer { padding: 20px; border-top: 1px solid rgba(255, 255, 255, 0.05); }
.status-indicator { display: flex; align-items: center; gap: 10px; font-size: 11px; font-weight: 600; letter-spacing: 1px; color: rgba(255, 255, 255, 0.5); }
.status-dot { width: 8px; height: 8px; border-radius: 50%; background: #00ff88; box-shadow: 0 0 10px #00ff88; animation: pulse 2s infinite; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

.content-area { flex: 1; margin-left: 260px; padding: 30px; background: linear-gradient(135deg, #0a0a12 0%, #12121f 100%); min-height: 100vh; }

.page-header { margin-bottom: 25px; }
.header-content { display: flex; justify-content: space-between; align-items: flex-start; }
.page-title { display: flex; align-items: center; gap: 15px; font-size: 24px; font-weight: 700; color: #fff; margin: 0 0 8px 0; }
.page-title svg { width: 28px; height: 28px; color: #00d4ff; }
.page-subtitle { color: rgba(255, 255, 255, 0.5); font-size: 13px; margin: 0 0 0 43px; }
.quick-stats { display: flex; gap: 15px; }
.quick-stat { text-align: center; padding: 15px 20px; border-radius: 10px; }
.quick-stat.cyan { background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); }
.quick-stat.purple { background: rgba(167, 139, 250, 0.1); border: 1px solid rgba(167, 139, 250, 0.3); }
.quick-stat.green { background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.3); }
.quick-stat .stat-value { display: block; font-size: 24px; font-weight: 700; }
.quick-stat.cyan .stat-value { color: #00d4ff; }
.quick-stat.purple .stat-value { color: #a78bfa; }
.quick-stat.green .stat-value { color: #00ff88; }
.quick-stat .stat-label { font-size: 10px; color: rgba(255, 255, 255, 0.5); text-transform: uppercase; }

.info-banner { display: flex; gap: 20px; padding: 20px; border-radius: 12px; margin-bottom: 25px; }
.info-banner.cyan { background: rgba(0, 212, 255, 0.05); border: 1px solid rgba(0, 212, 255, 0.2); }
.info-icon { width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: rgba(0, 212, 255, 0.1); border-radius: 10px; }
.info-icon svg { width: 24px; height: 24px; color: #00d4ff; }
.info-content h3 { font-size: 14px; font-weight: 600; color: #00d4ff; margin: 0 0 12px 0; }
.info-items { display: flex; flex-direction: column; gap: 8px; }
.info-item { display: flex; align-items: center; gap: 12px; font-size: 13px; color: rgba(255, 255, 255, 0.7); }
.badge { padding: 4px 10px; border-radius: 4px; font-size: 10px; font-weight: 700; text-transform: uppercase; }
.badge.cyan { background: rgba(0, 212, 255, 0.2); color: #00d4ff; border: 1px solid rgba(0, 212, 255, 0.4); }
.badge.purple { background: rgba(167, 139, 250, 0.2); color: #a78bfa; border: 1px solid rgba(167, 139, 250, 0.4); }
.badge.green { background: rgba(0, 255, 136, 0.2); color: #00ff88; border: 1px solid rgba(0, 255, 136, 0.4); }
.badge.orange { background: rgba(255, 107, 53, 0.2); color: #ff6b35; border: 1px solid rgba(255, 107, 53, 0.4); }

.tabs-section { margin-bottom: 25px; }
.tabs-nav { display: flex; gap: 10px; flex-wrap: wrap; }
.tab-btn { display: flex; align-items: center; gap: 10px; padding: 12px 20px; background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: rgba(255, 255, 255, 0.6); font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
.tab-btn svg { width: 18px; height: 18px; }
.tab-btn:hover { background: rgba(255, 255, 255, 0.05); color: #fff; }
.tab-btn.active.cyan { background: rgba(0, 212, 255, 0.1); border-color: rgba(0, 212, 255, 0.4); color: #00d4ff; }
.tab-btn.active.purple { background: rgba(167, 139, 250, 0.1); border-color: rgba(167, 139, 250, 0.4); color: #a78bfa; }
.tab-btn.active.green { background: rgba(0, 255, 136, 0.1); border-color: rgba(0, 255, 136, 0.4); color: #00ff88; }
.tab-btn.active.orange { background: rgba(255, 107, 53, 0.1); border-color: rgba(255, 107, 53, 0.4); color: #ff6b35; }

.content-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }

.form-panel { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 12px; overflow: hidden; }
.form-panel.hidden { display: none; }
.panel-header { display: flex; align-items: center; gap: 15px; padding: 20px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
.panel-header.cyan { background: linear-gradient(90deg, rgba(0, 212, 255, 0.1) 0%, transparent 100%); }
.panel-header.purple { background: linear-gradient(90deg, rgba(167, 139, 250, 0.1) 0%, transparent 100%); }
.panel-header.green { background: linear-gradient(90deg, rgba(0, 255, 136, 0.1) 0%, transparent 100%); }
.panel-header.orange { background: linear-gradient(90deg, rgba(255, 107, 53, 0.1) 0%, transparent 100%); }
.panel-icon { width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; border-radius: 10px; }
.panel-icon svg { width: 24px; height: 24px; }
.panel-header.cyan .panel-icon { background: rgba(0, 212, 255, 0.1); color: #00d4ff; }
.panel-header.purple .panel-icon { background: rgba(167, 139, 250, 0.1); color: #a78bfa; }
.panel-header.green .panel-icon { background: rgba(0, 255, 136, 0.1); color: #00ff88; }
.panel-header.orange .panel-icon { background: rgba(255, 107, 53, 0.1); color: #ff6b35; }
.panel-title h2 { font-size: 16px; font-weight: 600; margin: 0 0 4px 0; }
.panel-header.cyan .panel-title h2 { color: #00d4ff; }
.panel-header.purple .panel-title h2 { color: #a78bfa; }
.panel-header.green .panel-title h2 { color: #00ff88; }
.panel-header.orange .panel-title h2 { color: #ff6b35; }
.panel-title p { font-size: 12px; color: rgba(255, 255, 255, 0.5); margin: 0; }
.panel-body { padding: 20px; }

.profile-presets h4 { font-size: 12px; color: rgba(255, 255, 255, 0.6); margin: 0 0 12px 0; text-transform: uppercase; letter-spacing: 1px; }
.preset-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
.preset-card { padding: 15px; background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; text-align: center; cursor: pointer; transition: all 0.3s; }
.preset-card:hover { background: rgba(0, 212, 255, 0.05); border-color: rgba(0, 212, 255, 0.3); }
.preset-card.selected { background: rgba(0, 212, 255, 0.1); border-color: rgba(0, 212, 255, 0.5); }
.preset-icon { font-size: 24px; margin-bottom: 8px; }
.preset-card h5 { font-size: 13px; font-weight: 600; color: #fff; margin: 0 0 4px 0; }
.preset-card p { font-size: 11px; color: rgba(255, 255, 255, 0.5); margin: 0; }

.form-divider { height: 1px; background: rgba(255, 255, 255, 0.05); margin: 20px 0; }

.form-group { margin-bottom: 18px; }
.form-label { display: flex; align-items: center; gap: 8px; font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-bottom: 8px; }
.form-label svg { width: 14px; height: 14px; color: rgba(255, 255, 255, 0.4); }
.form-input { width: 100%; padding: 12px 15px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #fff; font-size: 13px; transition: all 0.3s ease; }
.form-input:focus { outline: none; background: rgba(0, 0, 0, 0.4); }
.form-input.cyan:focus { border-color: rgba(0, 212, 255, 0.5); box-shadow: 0 0 15px rgba(0, 212, 255, 0.1); }
.form-input.purple:focus { border-color: rgba(167, 139, 250, 0.5); }
.input-hint { font-size: 11px; color: rgba(255, 255, 255, 0.4); margin-top: 5px; }

.form-range { width: 100%; height: 6px; border-radius: 3px; background: rgba(255, 255, 255, 0.1); appearance: none; cursor: pointer; }
.form-range::-webkit-slider-thumb { appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #00d4ff; cursor: pointer; }
.range-value { text-align: center; font-size: 24px; font-weight: 700; color: #00d4ff; margin-top: 10px; }

.opsec-selector { display: flex; gap: 10px; }
.opsec-btn { flex: 1; padding: 15px 10px; background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: rgba(255, 255, 255, 0.6); font-size: 18px; font-weight: 700; cursor: pointer; text-align: center; transition: all 0.3s; }
.opsec-btn span { display: block; font-size: 10px; font-weight: 500; margin-top: 5px; }
.opsec-btn:hover { background: rgba(0, 212, 255, 0.05); border-color: rgba(0, 212, 255, 0.3); }
.opsec-btn.active { background: rgba(0, 212, 255, 0.1); border-color: rgba(0, 212, 255, 0.5); color: #00d4ff; }

.btn-submit { display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%; padding: 14px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
.btn-submit svg { width: 18px; height: 18px; }
.btn-submit.cyan { background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%); color: #000; }
.btn-submit.cyan:hover { box-shadow: 0 5px 20px rgba(0, 212, 255, 0.4); transform: translateY(-2px); }
.btn-submit.purple { background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%); color: #fff; }
.btn-submit.purple:hover { box-shadow: 0 5px 20px rgba(167, 139, 250, 0.4); transform: translateY(-2px); }

.pattern-info-cards { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px; }
.pattern-card { padding: 15px; background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; cursor: pointer; transition: all 0.3s; }
.pattern-card:hover { background: rgba(167, 139, 250, 0.05); border-color: rgba(167, 139, 250, 0.3); }
.pattern-icon { font-size: 24px; margin-bottom: 8px; }
.pattern-card h4 { font-size: 13px; font-weight: 600; color: #fff; margin: 0 0 4px 0; }
.pattern-card p { font-size: 11px; color: rgba(255, 255, 255, 0.5); margin: 0 0 8px 0; }
.pattern-best { font-size: 10px; color: #a78bfa; font-weight: 500; }

.jitter-chart { margin-top: 20px; min-height: 200px; background: rgba(0, 0, 0, 0.2); border-radius: 10px; padding: 20px; }
.chart-placeholder { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 160px; color: rgba(255, 255, 255, 0.4); }
.chart-placeholder svg { width: 40px; height: 40px; margin-bottom: 10px; opacity: 0.3; }
.chart-container { height: 160px; display: flex; flex-direction: column; }
.chart-bars { flex: 1; display: flex; align-items: flex-end; gap: 2px; }
.chart-bar { flex: 1; background: linear-gradient(to top, #a78bfa, #8b5cf6); border-radius: 2px 2px 0 0; min-height: 4px; transition: all 0.3s; }
.chart-bar:hover { background: #00d4ff; }
.chart-labels { display: flex; justify-content: space-between; font-size: 10px; color: rgba(255, 255, 255, 0.4); margin-top: 10px; }

.edr-card { padding: 15px; background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; margin-bottom: 12px; }
.edr-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.edr-name { font-size: 14px; font-weight: 600; color: #fff; }
.edr-capabilities { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-bottom: 12px; }
.capability { display: flex; align-items: center; gap: 8px; font-size: 11px; color: rgba(255, 255, 255, 0.4); }
.capability.active { color: #00ff88; }
.cap-icon { font-size: 12px; }
.edr-settings { display: flex; gap: 15px; font-size: 11px; color: rgba(255, 255, 255, 0.5); }

.session-card { padding: 15px; background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; margin-bottom: 12px; }
.session-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.session-id { font-size: 14px; font-weight: 600; color: #ff6b35; }
.session-details { display: flex; gap: 15px; font-size: 11px; color: rgba(255, 255, 255, 0.5); margin-bottom: 10px; }
.session-actions { display: flex; gap: 8px; }
.btn-mini { padding: 6px 12px; background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; color: #00d4ff; font-size: 11px; cursor: pointer; transition: all 0.2s; }
.btn-mini:hover { background: rgba(0, 212, 255, 0.2); }
.btn-mini.danger { background: rgba(255, 95, 86, 0.1); border-color: rgba(255, 95, 86, 0.3); color: #ff5f56; }
.btn-mini.danger:hover { background: rgba(255, 95, 86, 0.2); }

.stats-panel, .opsec-panel, .export-panel { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 12px; overflow: hidden; margin-bottom: 20px; }
.stats-header, .opsec-header, .export-header { display: flex; align-items: center; gap: 10px; padding: 15px 20px; background: rgba(0, 0, 0, 0.2); border-bottom: 1px solid rgba(255, 255, 255, 0.05); font-size: 13px; font-weight: 600; color: rgba(255, 255, 255, 0.7); }
.stats-header svg, .opsec-header svg, .export-header svg { width: 18px; height: 18px; color: #00d4ff; }
.stats-body, .opsec-body, .export-body { padding: 20px; }

.stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
.stat-item { text-align: center; padding: 15px; background: rgba(0, 212, 255, 0.05); border-radius: 8px; }
.stat-item .stat-label { display: block; font-size: 10px; color: rgba(255, 255, 255, 0.5); text-transform: uppercase; margin-bottom: 5px; }
.stat-item .stat-value { font-size: 18px; font-weight: 700; color: #00d4ff; }

.opsec-feature { display: flex; align-items: center; gap: 12px; padding: 10px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
.opsec-feature:last-child { border-bottom: none; }
.feature-icon { font-size: 18px; }
.feature-name { flex: 1; font-size: 13px; color: rgba(255, 255, 255, 0.8); }
.feature-status { font-size: 10px; font-weight: 700; padding: 4px 8px; border-radius: 4px; }
.feature-status.enabled { background: rgba(0, 255, 136, 0.2); color: #00ff88; }
.feature-status.disabled { background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.4); }

.btn-export { display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; padding: 12px; margin-top: 10px; background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 8px; color: #00d4ff; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
.btn-export:hover { background: rgba(0, 212, 255, 0.2); }
.btn-export svg { width: 16px; height: 16px; }

.terminal-panel { background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 12px; overflow: hidden; }
.terminal-header { display: flex; align-items: center; padding: 12px 15px; background: rgba(0, 0, 0, 0.3); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
.terminal-dots { display: flex; gap: 6px; margin-right: 15px; }
.dot { width: 10px; height: 10px; border-radius: 50%; }
.dot.red { background: #ff5f56; }
.dot.yellow { background: #ffbd2e; }
.dot.green { background: #27ca40; }
.terminal-title { display: flex; align-items: center; gap: 8px; flex: 1; font-size: 12px; color: rgba(255, 255, 255, 0.5); }
.terminal-title svg { width: 14px; height: 14px; }
.btn-clear { padding: 5px; background: transparent; border: none; color: rgba(255, 255, 255, 0.4); cursor: pointer; }
.btn-clear svg { width: 16px; height: 16px; }
.btn-clear:hover { color: #ff5f56; }
.terminal-body { height: 250px; overflow-y: auto; padding: 15px; font-family: 'Monaco', 'Menlo', monospace; font-size: 12px; }
.terminal-line { margin-bottom: 6px; display: flex; gap: 8px; }
.terminal-line .prompt { color: #00ff88; font-weight: 600; }
.terminal-line.error .prompt { color: #ff5f56; }
.terminal-line.warning .prompt { color: #ffbd2e; }
.terminal-line.success .prompt { color: #27ca40; }
.terminal-line span:last-child { color: rgba(255, 255, 255, 0.8); word-break: break-all; }
.terminal-divider { border-top: 1px dashed rgba(255, 255, 255, 0.1); margin: 10px 0; }
.divider { color: rgba(255, 255, 255, 0.2); }

.empty-state { text-align: center; padding: 40px 20px; color: rgba(255, 255, 255, 0.4); }
.empty-state svg { width: 40px; height: 40px; margin-bottom: 10px; opacity: 0.3; }
.empty-state p { margin: 0; font-size: 14px; }
.empty-state span { font-size: 12px; opacity: 0.7; }
</style>
{% endblock %}
