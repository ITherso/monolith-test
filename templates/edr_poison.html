<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDR Telemetry Poisoning - Shadow Arsenal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #00ff88;
            --primary-glow: #00ff8880;
            --danger: #ff3366;
            --danger-glow: #ff336680;
            --warning: #ffaa00;
            --info: #00d4ff;
            --gold: #ffd700;
            --gold-bright: #ffeb3b;
            --purple: #b366ff;
            --cyan: #00ffff;
            --red-alert: #ff0040;
            --bg-dark: #0a0a12;
            --bg-card: rgba(18, 18, 30, 0.95);
            --text-primary: #f0f0f0;
            --text-muted: #a0a0b0;
            --sidebar-width: 260px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0a12 0%, #0d0d1a 50%, #1a0a1a 100%);
            color: var(--text-primary);
            min-height: 100vh;
        }
        
        /* Animated toxic background */
        .bg-poison {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .bg-poison::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 30% 70%, rgba(255, 0, 64, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 70% 30%, rgba(179, 102, 255, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(0, 255, 136, 0.05) 0%, transparent 60%);
            animation: toxicPulse 10s ease-in-out infinite;
        }
        
        @keyframes toxicPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1) rotate(2deg); opacity: 0.8; }
        }
        
        .layout-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: rgba(15, 15, 25, 0.98);
            border-right: 1px solid rgba(255, 0, 64, 0.3);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            z-index: 100;
        }
        
        .sidebar-header {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }
        
        .sidebar-brand i {
            font-size: 1.8em;
            color: var(--danger);
            filter: drop-shadow(0 0 10px rgba(255, 51, 102, 0.5));
        }
        
        .sidebar-brand span {
            font-size: 1.4em;
            font-weight: 900;
            background: linear-gradient(90deg, #ff3366, var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .sidebar-nav {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 25px;
            color: var(--text-primary);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .nav-link:hover {
            background: rgba(255, 0, 64, 0.1);
            color: var(--red-alert);
            border-left-color: var(--red-alert);
        }
        
        .nav-link.active {
            background: rgba(255, 0, 64, 0.15);
            color: var(--red-alert);
            border-left: 3px solid var(--red-alert);
        }
        
        .nav-link i {
            width: 24px;
            text-align: center;
        }
        
        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            flex: 1;
            padding: 30px 40px;
        }
        
        /* Cards */
        .cyber-card {
            background: var(--bg-card);
            border: 1px solid rgba(255, 0, 64, 0.3);
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }
        
        .cyber-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--red-alert), var(--purple), transparent);
        }
        
        .card-header-cyber {
            background: linear-gradient(90deg, rgba(255, 0, 64, 0.15) 0%, transparent 100%);
            border-bottom: 1px solid rgba(255, 0, 64, 0.2);
            padding: 18px 25px;
        }
        
        .card-title-cyber {
            color: var(--red-alert);
            font-weight: 700;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 12px;
            text-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
        }
        
        .card-body {
            padding: 25px;
        }
        
        /* Stats */
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 0, 64, 0.3);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, rgba(255, 0, 64, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 0, 64, 0.2);
        }
        
        .stat-value {
            font-size: 2.8em;
            font-weight: 800;
            background: linear-gradient(135deg, var(--red-alert), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: none;
        }
        
        .stat-value.success {
            background: linear-gradient(135deg, var(--primary), #00cc6a);
            -webkit-background-clip: text;
        }
        
        .stat-value.warning {
            background: linear-gradient(135deg, var(--warning), #ff6600);
            -webkit-background-clip: text;
        }
        
        .stat-label {
            color: var(--text-muted);
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 8px;
            font-weight: 600;
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            color: var(--red-alert);
            font-weight: 700;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9em;
            text-shadow: 0 0 10px rgba(255, 0, 64, 0.3);
        }
        
        .form-control {
            width: 100%;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(255, 0, 64, 0.3);
            color: var(--text-primary);
            border-radius: 10px;
            padding: 14px 18px;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: var(--red-alert);
            box-shadow: 0 0 25px rgba(255, 0, 64, 0.3);
            outline: none;
        }
        
        .form-control option {
            background: #1a1a2e;
            color: #fff;
        }
        
        /* Buttons */
        .btn {
            border: none;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 10px;
            padding: 14px 28px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .btn-poison {
            background: linear-gradient(135deg, var(--red-alert) 0%, #cc0033 100%);
            color: #fff;
            box-shadow: 0 5px 25px rgba(255, 0, 64, 0.4);
        }
        
        .btn-poison:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 40px rgba(255, 0, 64, 0.6);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--primary) 0%, #00cc6a 100%);
            color: #000;
            box-shadow: 0 5px 25px rgba(0, 255, 136, 0.4);
        }
        
        .btn-purple {
            background: linear-gradient(135deg, var(--purple) 0%, #7a00cc 100%);
            color: #fff;
            box-shadow: 0 5px 25px rgba(179, 102, 255, 0.4);
        }
        
        /* Tabs */
        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 12px 25px;
            border: 2px solid rgba(255, 0, 64, 0.3);
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tab-btn:hover {
            background: rgba(255, 0, 64, 0.1);
            border-color: var(--red-alert);
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, rgba(255, 0, 64, 0.2), rgba(179, 102, 255, 0.2));
            border-color: var(--red-alert);
            color: var(--red-alert);
            box-shadow: 0 0 20px rgba(255, 0, 64, 0.2);
        }
        
        /* Category selector */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .category-item {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .category-item:hover {
            border-color: var(--purple);
            background: rgba(179, 102, 255, 0.1);
        }
        
        .category-item.selected {
            border-color: var(--red-alert);
            background: rgba(255, 0, 64, 0.15);
            box-shadow: 0 0 15px rgba(255, 0, 64, 0.2);
        }
        
        .category-item i {
            font-size: 1.5em;
            margin-bottom: 8px;
            display: block;
        }
        
        .category-item span {
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Event log */
        .event-log {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 0, 64, 0.2);
            border-radius: 10px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Fira Code', monospace;
            font-size: 0.85em;
        }
        
        .event-entry {
            padding: 10px 15px;
            margin-bottom: 8px;
            border-radius: 6px;
            border-left: 3px solid;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .event-entry.critical {
            border-left-color: var(--red-alert);
            background: rgba(255, 0, 64, 0.1);
        }
        
        .event-entry.high {
            border-left-color: var(--warning);
            background: rgba(255, 170, 0, 0.1);
        }
        
        .event-entry.medium {
            border-left-color: var(--info);
            background: rgba(0, 212, 255, 0.1);
        }
        
        .event-timestamp {
            color: var(--text-muted);
            font-size: 0.85em;
        }
        
        .event-process {
            color: var(--primary);
            font-weight: 600;
        }
        
        .event-description {
            color: var(--text-primary);
            margin-top: 5px;
        }
        
        .event-mitre {
            display: inline-block;
            background: rgba(179, 102, 255, 0.2);
            color: var(--purple);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            margin-top: 5px;
        }
        
        /* Campaign card */
        .campaign-card {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 0, 64, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .campaign-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .campaign-id {
            font-family: monospace;
            color: var(--red-alert);
            font-weight: 700;
            text-shadow: 0 0 10px rgba(255, 0, 64, 0.3);
        }
        
        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .status-running {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid var(--primary);
            color: var(--primary);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        .status-stopped {
            background: rgba(255, 0, 64, 0.2);
            border: 1px solid var(--red-alert);
            color: var(--red-alert);
        }
        
        .status-completed {
            background: rgba(179, 102, 255, 0.2);
            border: 1px solid var(--purple);
            color: var(--purple);
        }
        
        /* Progress bar */
        .progress-bar {
            height: 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 15px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--red-alert), var(--purple));
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        /* Hidden tabs */
        .hidden {
            display: none !important;
        }
        
        /* Animation */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Alert */
        .alert-box {
            background: rgba(255, 0, 64, 0.15);
            border: 2px solid var(--red-alert);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .alert-box i {
            font-size: 1.5em;
            color: var(--red-alert);
        }
        
        .alert-box p {
            color: #ffb3c1;
            line-height: 1.6;
        }
        
        /* Code block */
        .code-block {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 10px;
            padding: 20px;
            font-family: 'Fira Code', monospace;
            font-size: 0.9em;
            color: var(--primary);
            max-height: 300px;
            overflow: auto;
            white-space: pre-wrap;
        }
        
        /* EDR icons */
        .edr-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .edr-item {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .edr-item:hover {
            border-color: var(--info);
        }
        
        .edr-item.selected {
            border-color: var(--red-alert);
            background: rgba(255, 0, 64, 0.1);
        }
        
        .edr-item img {
            height: 40px;
            margin-bottom: 10px;
            filter: grayscale(0.5);
        }
        
        .edr-item.selected img {
            filter: none;
        }
        
        .edr-item span {
            display: block;
            font-size: 0.85em;
            color: var(--text-muted);
        }
        
        @media (max-width: 1200px) {
            .stat-grid { grid-template-columns: repeat(2, 1fr); }
            .category-grid { grid-template-columns: repeat(3, 1fr); }
        }
        
        @media (max-width: 768px) {
            .sidebar { width: 70px; }
            .sidebar-brand span, .nav-link span { display: none; }
            .main-content { margin-left: 70px; padding: 20px; }
            .stat-grid { grid-template-columns: 1fr; }
            .category-grid { grid-template-columns: repeat(2, 1fr); }
            .edr-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="bg-poison"></div>
    
    <div class="layout-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="/" class="sidebar-brand">
                    <i class="fas fa-skull-crossbones"></i>
                    <span>SHADOW ARSENAL</span>
                </a>
            </div>
            
            <nav class="sidebar-nav">
                <a href="/" class="nav-link"><i class="fas fa-home"></i><span>Dashboard</span></a>
                <a href="/scans" class="nav-link"><i class="fas fa-radar"></i><span>Scans</span></a>
                <a href="/evasion" class="nav-link"><i class="fas fa-ghost"></i><span>Evasion</span></a>
                <a href="/evasion/edr-poison" class="nav-link active"><i class="fas fa-biohazard"></i><span>EDR Poison</span></a>
                <a href="/phishing" class="nav-link"><i class="fas fa-fish"></i><span>Phishing</span></a>
                <a href="/c2" class="nav-link"><i class="fas fa-satellite-dish"></i><span>C2 Framework</span></a>
                <a href="/kerberos" class="nav-link"><i class="fas fa-key"></i><span>Kerberos</span></a>
                <a href="/attack-graph" class="nav-link"><i class="fas fa-project-diagram"></i><span>Attack Graph</span></a>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="cyber-card fade-in">
                <div class="card-body">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
                        <div>
                            <h1 style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                                <i class="fas fa-biohazard" style="color: var(--red-alert); font-size: 1.5em; filter: drop-shadow(0 0 20px rgba(255,0,64,0.5));"></i>
                                <span style="background: linear-gradient(90deg, var(--red-alert), var(--purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">EDR TELEMETRY POISONING</span>
                            </h1>
                            <p style="color: var(--text-primary); font-size: 1.1em;">
                                <i class="fas fa-radiation me-2" style="color: var(--warning);"></i>
                                Flood EDR with false positives to exhaust SOC analysts and hide real attacks
                            </p>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-secondary" onclick="exportEvents()">
                                <i class="fas fa-download"></i> Export
                            </button>
                            <button class="btn btn-poison" onclick="showTab('generator')">
                                <i class="fas fa-bolt"></i> Generate Noise
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Alert -->
            <div class="alert-box fade-in">
                <i class="fas fa-exclamation-triangle"></i>
                <div>
                    <strong style="color: var(--red-alert);">SOC Fatigue Attack</strong>
                    <p>This module generates fake malicious telemetry to overwhelm security analysts. 
                    Each noise event mimics real attack patterns (ransomware, credential theft, lateral movement) 
                    to trigger EDR alerts. Use during red team operations to mask actual attack chains.</p>
                </div>
            </div>
            
            <!-- Statistics -->
            <div class="stat-grid fade-in">
                <div class="stat-card">
                    <div class="stat-value" id="totalEvents">0</div>
                    <div class="stat-label">Events Generated</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value success" id="activeCampaigns">0</div>
                    <div class="stat-label">Active Campaigns</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value warning" id="criticalAlerts">0</div>
                    <div class="stat-label">Critical Alerts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="estimatedFatigue">0h</div>
                    <div class="stat-label">SOC Fatigue Time</div>
                </div>
            </div>
            
            <!-- Tabs -->
            <div class="tab-container fade-in">
                <button class="tab-btn active" onclick="showTab('generator', this)">
                    <i class="fas fa-bolt"></i> Noise Generator
                </button>
                <button class="tab-btn" onclick="showTab('campaigns', this)">
                    <i class="fas fa-list"></i> Campaigns
                </button>
                <button class="tab-btn" onclick="showTab('events', this)">
                    <i class="fas fa-stream"></i> Event Log
                </button>
                <button class="tab-btn" onclick="showTab('scripts', this)">
                    <i class="fas fa-code"></i> Scripts
                </button>
                <button class="tab-btn" onclick="showTab('edr-patterns', this)">
                    <i class="fas fa-fingerprint"></i> EDR Patterns
                </button>
            </div>
            
            <!-- Generator Tab -->
            <div id="generator-tab" class="fade-in">
                <div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                    <div class="cyber-card">
                        <div class="card-header-cyber">
                            <h5 class="card-title-cyber">
                                <i class="fas fa-cog"></i> INSTANT NOISE GENERATOR
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Target EDR Solution</label>
                                <select id="targetEdr" class="form-control">
                                    <option value="generic">Generic (All EDRs)</option>
                                    <option value="microsoft_defender">Microsoft Defender for Endpoint</option>
                                    <option value="crowdstrike_falcon">CrowdStrike Falcon</option>
                                    <option value="sentinelone">SentinelOne</option>
                                    <option value="carbon_black">Carbon Black</option>
                                    <option value="cortex_xdr">Palo Alto Cortex XDR</option>
                                    <option value="elastic_security">Elastic Security</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Noise Intensity</label>
                                <select id="intensity" class="form-control">
                                    <option value="low">Low (10-50 events) - Subtle</option>
                                    <option value="medium" selected>Medium (50-200 events) - Recommended</option>
                                    <option value="high">High (200-500 events) - Aggressive</option>
                                    <option value="extreme">EXTREME (500+ events) - SOC Killer</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Attack Categories</label>
                                <div class="category-grid">
                                    <div class="category-item selected" data-category="ransomware_simulation" onclick="toggleCategory(this)">
                                        <i class="fas fa-lock" style="color: var(--red-alert);"></i>
                                        <span>Ransomware</span>
                                    </div>
                                    <div class="category-item selected" data-category="credential_access" onclick="toggleCategory(this)">
                                        <i class="fas fa-key" style="color: var(--warning);"></i>
                                        <span>Cred Access</span>
                                    </div>
                                    <div class="category-item" data-category="lateral_movement" onclick="toggleCategory(this)">
                                        <i class="fas fa-arrows-alt" style="color: var(--info);"></i>
                                        <span>Lateral Mov</span>
                                    </div>
                                    <div class="category-item" data-category="persistence" onclick="toggleCategory(this)">
                                        <i class="fas fa-anchor" style="color: var(--purple);"></i>
                                        <span>Persistence</span>
                                    </div>
                                    <div class="category-item" data-category="defense_evasion" onclick="toggleCategory(this)">
                                        <i class="fas fa-eye-slash" style="color: var(--primary);"></i>
                                        <span>Evasion</span>
                                    </div>
                                    <div class="category-item" data-category="discovery" onclick="toggleCategory(this)">
                                        <i class="fas fa-search" style="color: var(--cyan);"></i>
                                        <span>Discovery</span>
                                    </div>
                                    <div class="category-item" data-category="exfiltration" onclick="toggleCategory(this)">
                                        <i class="fas fa-upload" style="color: var(--danger);"></i>
                                        <span>Exfiltration</span>
                                    </div>
                                    <div class="category-item" data-category="command_and_control" onclick="toggleCategory(this)">
                                        <i class="fas fa-satellite-dish" style="color: var(--gold);"></i>
                                        <span>C2</span>
                                    </div>
                                    <div class="category-item" data-category="process_injection" onclick="toggleCategory(this)">
                                        <i class="fas fa-syringe" style="color: #ff66b2;"></i>
                                        <span>Injection</span>
                                    </div>
                                    <div class="category-item" data-category="execution" onclick="toggleCategory(this)">
                                        <i class="fas fa-play" style="color: #66ffcc;"></i>
                                        <span>Execution</span>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="btn btn-poison w-100" onclick="generateInstantNoise()" style="width: 100%;">
                                <i class="fas fa-radiation"></i> Generate Noise Burst
                            </button>
                        </div>
                    </div>
                    
                    <div class="cyber-card">
                        <div class="card-header-cyber">
                            <h5 class="card-title-cyber">
                                <i class="fas fa-clock"></i> SCHEDULED CAMPAIGN
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Campaign Name</label>
                                <input type="text" id="campaignName" class="form-control" placeholder="Operation SOC Overload">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Duration (Minutes)</label>
                                <input type="number" id="campaignDuration" class="form-control" value="30" min="1" max="1440">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Noise Pattern</label>
                                <select id="noisePattern" class="form-control">
                                    <option value="constant">Constant - Steady noise stream</option>
                                    <option value="burst">Burst - Random intense bursts</option>
                                    <option value="escalating">Escalating - Gradually increase</option>
                                    <option value="random">Random - Unpredictable pattern</option>
                                </select>
                            </div>
                            
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-success" onclick="createCampaign()" style="flex: 1;">
                                    <i class="fas fa-plus"></i> Create Campaign
                                </button>
                                <button class="btn btn-secondary" onclick="showTab('campaigns')">
                                    <i class="fas fa-list"></i> View All
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Campaigns Tab -->
            <div id="campaigns-tab" class="hidden fade-in">
                <div class="cyber-card">
                    <div class="card-header-cyber">
                        <h5 class="card-title-cyber">
                            <i class="fas fa-list"></i> ACTIVE CAMPAIGNS
                        </h5>
                    </div>
                    <div class="card-body" id="campaignList">
                        <!-- Campaigns loaded dynamically -->
                        <div style="text-align: center; padding: 40px; color: var(--text-muted);">
                            <i class="fas fa-inbox fa-3x" style="opacity: 0.3; margin-bottom: 15px;"></i>
                            <p>No active campaigns. Create one to start poisoning EDR telemetry.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Events Tab -->
            <div id="events-tab" class="hidden fade-in">
                <div class="cyber-card">
                    <div class="card-header-cyber">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h5 class="card-title-cyber">
                                <i class="fas fa-stream"></i> GENERATED EVENTS
                            </h5>
                            <button class="btn btn-secondary" onclick="clearEvents()" style="padding: 8px 15px; font-size: 0.85em;">
                                <i class="fas fa-trash"></i> Clear
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="event-log" id="eventLog">
                            <div style="text-align: center; padding: 30px; color: var(--text-muted);">
                                <i class="fas fa-radiation fa-2x" style="opacity: 0.3; margin-bottom: 10px;"></i>
                                <p>Generate noise to see events here...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Scripts Tab -->
            <div id="scripts-tab" class="hidden fade-in">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                    <div class="cyber-card">
                        <div class="card-header-cyber">
                            <h5 class="card-title-cyber">
                                <i class="fab fa-windows"></i> POWERSHELL NOISE
                            </h5>
                        </div>
                        <div class="card-body">
                            <p style="color: var(--text-muted); margin-bottom: 15px;">
                                Generate benign commands that trigger EDR alerts
                            </p>
                            <div class="form-group">
                                <label class="form-label">Script Type</label>
                                <select id="psScriptType" class="form-control">
                                    <option value="discovery">Discovery Noise</option>
                                    <option value="credential_access">Credential Access Sim</option>
                                    <option value="defense_evasion">Defense Evasion Sim</option>
                                </select>
                            </div>
                            <button class="btn btn-purple" onclick="generatePsScript()" style="width: 100%;">
                                <i class="fas fa-code"></i> Generate Script
                            </button>
                            <div class="code-block" id="psScriptOutput" style="margin-top: 15px; display: none;"></div>
                        </div>
                    </div>
                    
                    <div class="cyber-card">
                        <div class="card-header-cyber">
                            <h5 class="card-title-cyber">
                                <i class="fab fa-python"></i> PYTHON NOISE
                            </h5>
                        </div>
                        <div class="card-body">
                            <p style="color: var(--text-muted); margin-bottom: 15px;">
                                Cross-platform noise generator script
                            </p>
                            <button class="btn btn-success" onclick="generatePyScript()" style="width: 100%; margin-top: 30px;">
                                <i class="fas fa-code"></i> Generate Python Script
                            </button>
                            <div class="code-block" id="pyScriptOutput" style="margin-top: 15px; display: none;"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- EDR Patterns Tab -->
            <div id="edr-patterns-tab" class="hidden fade-in">
                <div class="cyber-card">
                    <div class="card-header-cyber">
                        <h5 class="card-title-cyber">
                            <i class="fas fa-fingerprint"></i> EDR-SPECIFIC TRIGGER PATTERNS
                        </h5>
                    </div>
                    <div class="card-body">
                        <p style="color: var(--text-muted); margin-bottom: 20px;">
                            Each EDR has specific behavioral patterns that trigger alerts. Select an EDR to view its trigger patterns.
                        </p>
                        
                        <div class="edr-grid">
                            <div class="edr-item selected" onclick="selectEdr(this, 'defender')">
                                <i class="fab fa-microsoft fa-2x" style="color: #00a4ef;"></i>
                                <span>Microsoft Defender</span>
                            </div>
                            <div class="edr-item" onclick="selectEdr(this, 'crowdstrike')">
                                <i class="fas fa-crow fa-2x" style="color: #ff4444;"></i>
                                <span>CrowdStrike</span>
                            </div>
                            <div class="edr-item" onclick="selectEdr(this, 'sentinelone')">
                                <i class="fas fa-shield-alt fa-2x" style="color: #6c3eff;"></i>
                                <span>SentinelOne</span>
                            </div>
                        </div>
                        
                        <div id="edrPatterns" style="margin-top: 20px;">
                            <!-- Patterns loaded dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script>
        let selectedCategories = ['ransomware_simulation', 'credential_access'];
        let generatedEvents = [];
        
        function showTab(tabName, btn) {
            // Hide all tabs
            document.querySelectorAll('[id$="-tab"]').forEach(tab => tab.classList.add('hidden'));
            
            // Show selected tab
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.remove('hidden');
            }
            
            // Update buttons
            if (btn) {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            }
            
            // Load data for specific tabs
            if (tabName === 'campaigns') loadCampaigns();
            if (tabName === 'edr-patterns') loadEdrPatterns('defender');
        }
        
        function toggleCategory(element) {
            element.classList.toggle('selected');
            const category = element.dataset.category;
            
            if (element.classList.contains('selected')) {
                if (!selectedCategories.includes(category)) {
                    selectedCategories.push(category);
                }
            } else {
                selectedCategories = selectedCategories.filter(c => c !== category);
            }
        }
        
        async function generateInstantNoise() {
            const edr = document.getElementById('targetEdr').value;
            const intensity = document.getElementById('intensity').value;
            
            if (selectedCategories.length === 0) {
                showNotification('Select at least one attack category', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/edr-poison/generate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        categories: selectedCategories,
                        intensity: intensity,
                        target_edr: edr
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    generatedEvents = data.events;
                    updateStats();
                    updateEventLog(data.events);
                    showNotification(`Generated ${data.events_generated} noise events!`, 'success');
                } else {
                    showNotification('Error: ' + data.error, 'error');
                }
            } catch (e) {
                showNotification('API Error: ' + e.message, 'error');
            }
        }
        
        async function createCampaign() {
            const name = document.getElementById('campaignName').value || 'Untitled Campaign';
            const duration = parseInt(document.getElementById('campaignDuration').value) || 30;
            const edr = document.getElementById('targetEdr').value;
            const intensity = document.getElementById('intensity').value;
            
            try {
                const response = await fetch('/api/edr-poison/campaign/create', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        name: name,
                        duration_minutes: duration,
                        target_edr: edr,
                        intensity: intensity,
                        categories: selectedCategories
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(`Campaign "${name}" created! ID: ${data.campaign.campaign_id}`, 'success');
                    showTab('campaigns');
                } else {
                    showNotification('Error: ' + data.error, 'error');
                }
            } catch (e) {
                showNotification('API Error: ' + e.message, 'error');
            }
        }
        
        async function loadCampaigns() {
            try {
                const response = await fetch('/api/edr-poison/campaigns');
                const data = await response.json();
                
                const container = document.getElementById('campaignList');
                
                if (data.campaigns && data.campaigns.length > 0) {
                    container.innerHTML = data.campaigns.map(c => `
                        <div class="campaign-card">
                            <div class="campaign-header">
                                <div>
                                    <span class="campaign-id">${c.campaign_id}</span>
                                    <span style="margin-left: 15px; color: var(--text-muted);">${c.name}</span>
                                </div>
                                <span class="status-badge status-${c.status}">${c.status.toUpperCase()}</span>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 15px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 1.3em; font-weight: 700; color: var(--red-alert);">${c.events_generated}</div>
                                    <div style="font-size: 0.8em; color: var(--text-muted);">Events</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.3em; font-weight: 700; color: var(--purple);">${c.intensity}</div>
                                    <div style="font-size: 0.8em; color: var(--text-muted);">Intensity</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.3em; font-weight: 700; color: var(--info);">${c.duration_minutes}m</div>
                                    <div style="font-size: 0.8em; color: var(--text-muted);">Duration</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.3em; font-weight: 700; color: var(--warning);">${c.categories.length}</div>
                                    <div style="font-size: 0.8em; color: var(--text-muted);">Categories</div>
                                </div>
                            </div>
                            <div style="margin-top: 15px; display: flex; gap: 10px;">
                                ${c.status === 'created' ? `<button class="btn btn-success" onclick="startCampaign('${c.campaign_id}')" style="flex:1;padding:10px;"><i class="fas fa-play"></i> Start</button>` : ''}
                                ${c.status === 'running' ? `<button class="btn btn-poison" onclick="stopCampaign('${c.campaign_id}')" style="flex:1;padding:10px;"><i class="fas fa-stop"></i> Stop</button>` : ''}
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--text-muted);">
                            <i class="fas fa-inbox fa-3x" style="opacity: 0.3; margin-bottom: 15px;"></i>
                            <p>No campaigns found. Create one to start.</p>
                        </div>
                    `;
                }
            } catch (e) {
                console.error('Error loading campaigns:', e);
            }
        }
        
        async function startCampaign(campaignId) {
            try {
                const response = await fetch(`/api/edr-poison/campaign/${campaignId}/start`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (data.success) {
                    showNotification('Campaign started!', 'success');
                    loadCampaigns();
                }
            } catch (e) {
                showNotification('Error: ' + e.message, 'error');
            }
        }
        
        async function stopCampaign(campaignId) {
            try {
                const response = await fetch(`/api/edr-poison/campaign/${campaignId}/stop`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (data.success) {
                    showNotification('Campaign stopped!', 'success');
                    loadCampaigns();
                }
            } catch (e) {
                showNotification('Error: ' + e.message, 'error');
            }
        }
        
        function updateEventLog(events) {
            const container = document.getElementById('eventLog');
            
            if (events && events.length > 0) {
                container.innerHTML = events.slice(0, 50).map(e => `
                    <div class="event-entry ${e.severity}">
                        <div style="display: flex; justify-content: space-between;">
                            <span class="event-process">${e.process_name}</span>
                            <span class="event-timestamp">${e.timestamp}</span>
                        </div>
                        <div class="event-description">${e.command_line || e.description}</div>
                        <span class="event-mitre">${e.mitre_technique}</span>
                    </div>
                `).join('');
            }
        }
        
        function updateStats() {
            fetch('/api/edr-poison/stats')
                .then(r => r.json())
                .then(data => {
                    document.getElementById('totalEvents').textContent = data.total_events || 0;
                    document.getElementById('activeCampaigns').textContent = data.active_campaigns || 0;
                    document.getElementById('criticalAlerts').textContent = data.by_severity?.critical || 0;
                    
                    // Estimate SOC fatigue (rough calculation)
                    const events = data.total_events || 0;
                    const hours = Math.round(events / 50); // ~50 events per hour to investigate
                    document.getElementById('estimatedFatigue').textContent = hours + 'h';
                });
        }
        
        async function clearEvents() {
            try {
                await fetch('/api/edr-poison/clear', { method: 'POST' });
                document.getElementById('eventLog').innerHTML = `
                    <div style="text-align: center; padding: 30px; color: var(--text-muted);">
                        <i class="fas fa-radiation fa-2x" style="opacity: 0.3; margin-bottom: 10px;"></i>
                        <p>Events cleared. Generate more noise...</p>
                    </div>
                `;
                updateStats();
                showNotification('Events cleared', 'success');
            } catch (e) {
                showNotification('Error clearing events', 'error');
            }
        }
        
        function generatePsScript() {
            const type = document.getElementById('psScriptType').value;
            const output = document.getElementById('psScriptOutput');
            
            const scripts = {
                discovery: `# Discovery Noise Generator
$ErrorActionPreference = "SilentlyContinue"
whoami /all
net user /domain
net group "Domain Admins" /domain
net localgroup administrators
nltest /dclist:$env:USERDNSDOMAIN
ipconfig /all
netstat -ano
systeminfo
tasklist /v
arp -a
Write-Host "[+] Discovery noise complete"`,
                credential_access: `# Credential Access Simulation (SAFE)
$ErrorActionPreference = "SilentlyContinue"
# These trigger alerts but won't work without admin
reg query HKLM\\SAM 2>$null
reg query HKLM\\SECURITY 2>$null
Get-Process lsass -EA SilentlyContinue | Out-Null
setspn -Q */* 2>$null | Out-Null
klist tickets 2>$null | Out-Null
Write-Host "[+] Credential noise complete"`,
                defense_evasion: `# Defense Evasion Simulation
$ErrorActionPreference = "SilentlyContinue"
Get-MpPreference -EA SilentlyContinue | Out-Null
Get-Service WinDefend -EA SilentlyContinue | Out-Null
wevtutil qe Security /c:1 /f:text 2>$null | Out-Null
Write-Host "[+] Evasion noise complete"`
            };
            
            output.textContent = scripts[type] || '# No script available';
            output.style.display = 'block';
        }
        
        function generatePyScript() {
            const output = document.getElementById('pyScriptOutput');
            output.textContent = `#!/usr/bin/env python3
"""EDR Noise Generator - Cross Platform"""
import os, subprocess, socket, platform

def run(cmd):
    try: subprocess.run(cmd, shell=True, capture_output=True, timeout=5)
    except: pass

def discovery_noise():
    cmds = ["whoami", "ipconfig /all" if platform.system()=="Windows" else "ifconfig", 
            "netstat -ano", "arp -a"]
    for c in cmds: run(c)

def network_noise():
    for d in ["cdn.example.com", "api.github.com"]:
        try: socket.gethostbyname(d)
        except: pass

if __name__ == "__main__":
    print("[*] Generating EDR noise...")
    discovery_noise()
    network_noise()
    print("[+] Complete")`;
            output.style.display = 'block';
        }
        
        function selectEdr(element, edr) {
            document.querySelectorAll('.edr-item').forEach(e => e.classList.remove('selected'));
            element.classList.add('selected');
            loadEdrPatterns(edr);
        }
        
        async function loadEdrPatterns(edr) {
            const container = document.getElementById('edrPatterns');
            
            const patterns = {
                defender: {
                    ransomware: ['vssadmin delete shadows', 'bcdedit /set recoveryenabled no', 'wmic shadowcopy delete'],
                    credential: ['rundll32 comsvcs.dll MiniDump', 'procdump -ma lsass', 'reg save HKLM\\SAM'],
                    lateral: ['psexec \\\\target cmd', 'wmic /node:target process call create']
                },
                crowdstrike: {
                    ransomware: ['Get-WmiObject Win32_ShadowCopy | Remove-WmiObject'],
                    credential: ['[Marshal]::SecureStringToBSTR', 'certutil -urlcache -split -f'],
                    injection: ['[Reflection.Assembly]::Load', 'mshta vbscript:Execute']
                },
                sentinelone: {
                    ransomware: ['bcdedit /set bootstatuspolicy ignoreallfailures'],
                    evasion: ['Set-MpPreference -DisableRealtimeMonitoring', 'sc stop WinDefend']
                }
            };
            
            const edrPatterns = patterns[edr] || {};
            
            container.innerHTML = Object.entries(edrPatterns).map(([category, cmds]) => `
                <div style="margin-bottom: 20px;">
                    <h6 style="color: var(--red-alert); text-transform: uppercase; margin-bottom: 10px;">
                        <i class="fas fa-caret-right me-2"></i>${category}
                    </h6>
                    <div class="code-block">
${cmds.map(c => `# ${c}`).join('\n')}
                    </div>
                </div>
            `).join('');
        }
        
        function exportEvents() {
            fetch('/api/edr-poison/export?format=json')
                .then(r => r.text())
                .then(data => {
                    const blob = new Blob([data], {type: 'application/json'});
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'edr_poison_events.json';
                    a.click();
                });
        }
        
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'var(--primary)',
                error: 'var(--red-alert)',
                info: 'var(--info)'
            };
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type]};
                color: ${type === 'success' ? '#000' : '#fff'};
                padding: 15px 25px;
                border-radius: 10px;
                font-weight: 600;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
                box-shadow: 0 5px 25px rgba(0,0,0,0.3);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.remove(), 3000);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
        });
    </script>
</body>
</html>
